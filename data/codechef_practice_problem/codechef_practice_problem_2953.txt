
 Read problems statements in Mandarin Chinese here
 Read problems statements in Russian here
Problem Statement
Chef has a string S = S1S2 ... SN, consisting of N lowercase Latin letters. Also he has M pairs of integers Li, Ri (1 ≤ Li ≤ Ri ≤ N).For each pair Li, Ri, Chef writes out all distinct substrings of string S, which are started from positions Li, Li + 1, ..., Ri.Your task is to help Chef. That is, for each pair, find out how many substrings that he needs to write.InputThe first line of the input contains an integer T denoting the number of test cases. The description of T test cases follows.The first line of each test case contains non-empty string S and the second line contains positive integer M.
Each of the next M lines contains a pair of integers Li, Ri.
OutputFor each pair of each test case print the required number of substrings.Constraints
String S contains only lowercase Latin letters.
1 ≤ Li ≤ Ri ≤ N.Sum of all length's of S for test cases is not greater than 50000. Sum of all M values for test cases is not greater than 50000.
Example
Input:
2
ababa
4
1 1
1 5
5 5
3 4
a
1
1 1
Output:
5
9
1
5
1




Author:
6★gerald


Tester:
2★rustinpiece


Editorial:
https://discuss.codechef.com/problems/GERALD3


Tags:

               
                 Sets, Suffix Arrays, Mo's Algorithm, Longest Common Prefix, Offline Queries
                 
                     
                     Data Structures, Advanced Data Structures, Suffix Structures, Advanced Algorithms, Pre processing, Algorithms, Dynamic Programming, DP on sequences, Queries
                 
               
             
             



                        Difficulty Rating:
                    

2965


Date Added:
8-11-2013


Time Limit:
7 secs


Source Limit:
50000 Bytes


Languages:
PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, BASH, JS, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, PIKE, SCM qobi, ST, NEM





Submit

