read,problems,statements,mandarin,chinese,russian,vietnamese,wonderland,wonderful,world,inhabited,strange,creatures,simplicity,creatures,numbered,creature,friend,note,friendship,relationship,bidirectional,meaning,case,person,friend,friend,intricate,admiration,relationship,creatures,creature,admires,creatures,admired,friend,wonderland,divided,guilds,creature,belonging,guild,guild,creature,guild,defined,largest,set,creatures,creatures,exists,creature,admire,friend,relationship,persons,guilds,formed,uniquely,defined,queen,hearts,angry,stole,tarts,perform,executions,executions,creatures,lose,friend,stop,admiring,creatures,admired,friend,consequence,number,guilds,change,alice,queries,form,asks,determine,number,guilds,executions,survivors,creatures,numbered,input,line,input,integers,line,space,separated,integers,i-th,integer,ai,represents,friend,i-th,creature,lines,integers,representing,query,output,query,output,number,guilds,execution,constraints,≤,≤,≤,≤,≤,≤,ai,≤,input,output,explanation,initially,guild,executions,query,guilds,{,{1,2},{3,4},{5}{6},},executions,query,guilds,{,{7,8},{9},},executions,query,guilds,{,{34},{5}{6},},author,7★alei,tester,6★kingofnumbers,editorial,https://discuss.codechef.com/problems/QUEHEA,tags,segment,trees,fenwick,trees,connected,components,range,queries,advanced,data,structures,advanced,tree,structures,advanced,algorithms,advanced,graph,algos,algorithms,queries,difficulty,rating,date,added,25-07-2016,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,perl,scala,lua,bash,js,lisp,sbcl,pas,gpc,bf,cloj,caml,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,scm,chicken,pike,scm,qobi,st,nem,submit