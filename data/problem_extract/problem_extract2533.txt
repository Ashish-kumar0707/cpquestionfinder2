read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,finals,chef's,combinatorial,games,competition,finalists,irshad,mehedi,ready,play,matter,game,final,round,chef,prepared,completely,game,rules,kk,stacks,stones,numbered,kk,valid,ii,ii-th,stack,threshold,hihi,initially,stack,stone,players,alternate,turns,irshad,plays,turn,current,player,choose,stacks,make,move,chosen,stack,make,move,stack,ii,xx,stones,beginning,current,turn,current,player,add,stones,stack,resulting,number,stones,yy,y>xy>x,divides,stack's,threshold,hihi,stack,hihi,stones,impossible,make,move,impossible,make,move,stack,current,player,loses,game,irshad,mehedi,brilliant,programmers,easily,play,game,optimally,thresholds,spice,game,chef,chose,kk,people,audience,gave,stack,provided,set,s={x1x2…xn}s={x1x2…xn},chosen,people,uniformly,randomly,independently,people,choose,threshold,his/her,stack,set,ss,happening,irshad,asks,hey,ways,people,set,thresholds,win,find,answer,modulo,109+7109+7,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,space-separated,integers,nn,kk,nn,lines,follow,valid,ii,ii-th,lines,single,integer,xixi,output,test,case,print,single,line,integer,―,number,ways,choose,thresholds,irshad,wins,modulo,109+7109+7,constraints,1≤t≤51≤t≤5,1≤n≤1000001≤n≤100000,1≤k≤1091≤k≤109,1≤xi≤1091≤xi≤109,valid,ii,x1x2…xnx1x2…xn,pairwise,distinct,subtasks,subtask,#1,points,nk≤12nk≤12,xi≤12xi≤12,valid,ii,subtask,#2,points,nk≤50000nk≤50000,xi≤50000xi≤50000,valid,ii,subtask,#3,points,original,constraints,sample,input,sample,output,explanation,case,choices,thresholds,losing,irshad,thresholds,mehedi,wins,regarless,irshad's,moves,remaining,choices,winning,irshad,author,6★upobir,editorial,https://discuss.codechef.com/problems/MDSWIN,tags,rabin,miller,test,fast,walsh,hadamard,transform,nim,game,mathematics,number,theory,transformations,primality,checking,algorithms,game,theory,difficulty,rating,date,added,1-10-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit