read,problem,statements,hindi,bengali,interactive,problem,sonya,creative,dreamy,person,decided,open,bakery,day,sonya,lives,country,traditional,dish,apple,pie,business,quickly,successful,sonya,chain,nn,bakeries,—,nn,cities,country,cities,numbered,nn,bakeries,numbered,cities,moment,bakery,number,pies,stock,denote,number,pies,stock,city,ii,aiai,bakeries,bake,unique,pies,country,built,n−1n−1,roads,reach,city,cities,roads,possibly,visiting,cities,roads,numbered,n−1n−1,country,sonya,lives,earthquakes,happen,frequently,roads,collapse,impossible,collapsed,road,repaired,bakery,define,connected,component,set,bakeries,including,reached,collapsed,roads,process,mm,events,types,events,corresponds,changing,country,sonya,information,related,business,type,state,ee-th,road,—,collapsed,collapses,collapsed,repaired,collapsed,type,xx-th,bakery,bakes,delivers,yy,pies,bakery,connected,component,including,words,bakery,ii,connected,component,bakery,xx,aiai,increases,yy,type,bakery,connected,component,xx-th,bakery,sends,pies,stock,xx-th,bakery,adds,stock,type,sonya,number,pies,stock,xx-th,bakery,type,sonya,total,number,pies,stock,connected,component,xx-th,bakery,type,bakery,connected,component,xx-th,bakery,including,sells,pies,stock,words,bakery,ii,connected,component,bakery,xx,aiai,type,sonya,minimum,number,roads,repaired,pair,bakeries,ii,jj,ai>0ai>0,aj>0aj>0,reach,bakery,ii,bakery,jj,collapsed,roads,answer,sonya's,queries,events,types,queries,answered,online,answer,query,order,receive,information,subsequent,events,grader,interaction,read,line,single,integer,gg,—,number,current,subtask,read,line,space-separated,integers,nn,mm,read,n−1n−1,lines,ii,1≤i≤n−11≤i≤n−1,ii-th,lines,space-separated,integers,uu,vv,denoting,cities,connected,ii-th,road,read,line,single,string,length,n−1n−1,valid,ii,ii-th,character,string,ii-th,road,initially,collapsed,collapsed,read,line,nn,space-separated,integers,a1a2…ana1a2…an,—,number,pies,stock,initially,finally,repeat,process,mm,times,read,line,describing,event,line,begins,integer,denoting,type,event,queries,type,integer,space,single,integer,ee,queries,type,space,space-separated,integers,xx,yy,queries,types,space,single,integer,xx,queries,type,type,event,print,single,line,integer,—,answer,query,forget,flush,output,printing,line,constraints,1≤g≤51≤g≤5,1≤nm≤2500001≤nm≤250000,1≤uv≤n1≤uv≤n,0≤ai≤1050≤ai≤105,valid,ii,1≤e≤n−11≤e≤n−1,1≤x≤n1≤x≤n,0≤y≤1050≤y≤105,subtasks,subtask,#1,points,1≤nm≤30001≤nm≤3000,subtask,#2,points,queries,type,event,type,road,collapsed,repaired,subtask,#3,points,queries,type,subtask,#4,points,city,directly,connected,cities,collapsed,uncollapsed,roads,subtask,#5,points,original,constraints,sample,input,sample,output,explanation,images,depict,initial,state,country,image,event,state,country,image,image,chronological,order,bakeries/cities,depicted,circles,uncollapsed,roads,regular,lines,collapsed,roads,dashed,lines,inside,circle,integers,—,number,city/bakery,number,pies,stock,author,7★smelskiy,editorial,https://discuss.codechef.com/problems/SONIQUE,tags,april19,data-structure,hard,melfice,segment-tree,smelskiy,treap,trees,difficulty,rating,date,added,3-04-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit