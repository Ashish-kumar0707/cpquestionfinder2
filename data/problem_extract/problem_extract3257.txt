read,problems,statements,hindi,mandarin,chinese,russian,vietnamese,bengali,chef,viewing,simulation,creating,tree,nn,vertices,numbered,nn,calculates,mysterious,coefficients,edges,initially,graph,edges,set,ss,n−1n−1,edges,numbered,n−1n−1,added,graph,process,n−1n−1,times,steps,performed,edge,ee,chosen,uniformly,randomly,current,set,ss,edge,added,graph,removed,ss,coefficient,ee,set,number,vertices,connected,component,created,adding,edge,chef,wondering,expected,values,coefficients,edges,time,matters,prepare,superb,cake,chefina's,birthday,tomorrow,chef,edge,calculate,expected,coefficient,modulo,prove,coefficient,rational,number,coefficient,form,p/qp/q,pp,qq,positive,integers,qq,coprime,compute,p⋅q−1p⋅q−1,modulo,q−1q−1,multiplicative,inverse,qq,modulo,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,single,integer,nn,n−1n−1,lines,describe,edges,ss,valid,ii,ii-th,lines,space-separated,integers,uu,vv,denoting,ii-th,edge,connects,vertices,uu,vv,output,test,case,print,single,line,n−1n−1,integers,valid,ii,ii-th,integers,r⋅q−1r⋅q−1,modulo,coefficient,ii-th,edge,constraints,2≤t≤100002≤t≤10000,2≤n≤500002≤n≤50000,1≤uv≤n1≤uv≤n,edges,ss,form,tree,sum,nn,test,cases,exceed,input,output,explanation,case,probability,1/21/2,edge,added,graph,coefficient,set,vertices,connected,component,probability,edge,added,coefficient,set,probability,1/21/2,edge,chosen,coefficient,set,case,coefficient,set,expected,coefficient,edge,2⋅1/2+3⋅1/2=5/22⋅1/2+3⋅1/2=5/2,edge,case,expected,values,coefficients,17/6317/617/6317/6,author,5★andrzej,editorial,https://discuss.codechef.com/problems/ANTUTREE,tags,trees,centroid,decomposition,expected,fft,dfs,data,structures,graphs,advanced,algorithms,advanced,graph,algos,mathematics,probability,transformations,algorithms,graph,algos,traversals,difficulty,rating,date,added,14-12-2020,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit