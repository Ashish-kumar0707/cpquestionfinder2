read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,chef,preparing,tests,problem,move,coins,create,tree,gg,nn,nodes,numbered,nn,rooted,node,list,qq,distinct,reparentings,reparenting,pair,nodes,uvuv,u≠1u≠1,gg,result,applying,gg,graph,formed,copy,original,tree,gg,copy,remove,edge,connecting,vertex,uu,parent,add,edge,nodes,uu,vv,tree,gg,apply,reparenting,r=63r=63,resulting,graph,reparenting,rr,valid,resulting,graph,tree,connected,graph,cycles,time,chef,generate,valid,reparentings,chef,decided,tree,gg,pick,qq,valid,reparentings,makes,initial,list,ll,valid,reparentings,tree,sorts,special,order,r=uvr=uv,r′=u′v′r′=u′v′,valid,reparentings,order,decided,uu′u>u′,r>r′r>r′,u=u′u=u′,find,distances,nodes,vv,v′v′,root,denote,hh,h′h′,u=u′u=u′,hh′h>h′,r>r′r>r′,u=u′u=u′,h=h′h=h′,vv′v>v′,r>r′r>r′,chef,chooses,qq,integers,c1c2…cqc1c2…cq,removes,c1c1-th,element,ll,removes,c2c2-th,element,resulting,smaller,list,ll,removes,cqcq-th,element,sequence,c1c2…cqc1c2…cq,chosen,process,valid,index,element,current,list,ll,removes,qq,distinct,valid,reparentings,test,chef,making,life,easy,sequence,c1c2…cqc1c2…cq,encrypted,elements,decrypted,previous,reparentings,found,formally,decryption,key,dd,initially,d=0d=0,encrypted,sequence,e1e2…eqe1e2…eq,integer,ii,qq,chef,decrypts,ci=ei⊕dci=ei⊕d,⊕⊕,denotes,bitwise,xor,operator,finds,cici-th,reparenting,current,list,ll,denoted,uiviuivi,removes,ll,updates,decryption,key,dd,d+2i⋅ui+3i⋅vi%109+7d+2i⋅ui+3i⋅vi%109+7,chef,find,qq,valid,reparentings,encrypted,choices,calculating,final,dd,suffice,show,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,single,integer,nn,n−1n−1,lines,space-separated,integers,aa,bb,denoting,nodes,aa,bb,connected,edge,line,single,integer,qq,qq,lines,follow,valid,ii,ii-th,lines,single,integer,eiei,output,test,case,print,single,line,integer,―,final,dd,processing,qq,reparentings,constraints,1≤t≤10001≤t≤1000,1≤nq≤2000001≤nq≤200000,1≤ab≤n1≤ab≤n,0≤ei≤2360≤ei≤236,valid,ii,1≤ci≤r+1−i1≤ci≤r+1−i,valid,ii,rr,number,valid,reparentings,sum,nn,test,cases,exceed,sum,qq,test,cases,exceed,subtasks,subtask,#1,points,t≤10t≤10,nq≤100nq≤100,subtask,#2,points,t≤100t≤100,nq≤1000nq≤1000,subtask,#3,points,original,constraints,sample,input,sample,output,explanation,case,tree,gg,reparentings,uvuv,draw,representative,sampling,valid,reparentings,marked,',invalid,',form,table,validity,reparentings,uvuv,initial,list,ll,formed,listing,pairs,uvuv,sorting,order,list,i=123i=123,decrypt,eiei,cici,find,reparenting,uiviuivi,current,list,ll,remove,ll,update,decryption,key,dd,initial,dd,encrypted,choice,e1=5e1=5,decrypt,c1=d⊕e1=0⊕5=5c1=d⊕e1=0⊕5=5,reparenting,choice,55-th,entry,current,list,ll,u1v1=34u1v1=34,update,dd,0+21⋅u1+31⋅v1%109+7=180+21⋅u1+31⋅v1%109+7=18,remove,55-th,element,ll,choice,e2=23e2=23,c2=18⊕23=5c2=18⊕23=5,reparenting,u2v2u2v2,update,dd,18+22⋅u2+32⋅v2%109+7=7518+22⋅u2+32⋅v2%109+7=75,remove,list,ll,final,choice,e3=72e3=72,decrypt,c3=75⊕72=3c3=75⊕72=3,reparenting,u3v3=31u3v3=31,update,dd,final,time,75+23⋅u3+33⋅v3%109+7=12675+23⋅u3+33⋅v3%109+7=126,processed,qq,choices,final,decryption,key,d=126d=126,case,tree,gg,reparentings,show,representative,sample,validity,table,validity,reparentings,listing,valid,sorting,order,initial,list,ll,initial,dd,encrypted,e1=9e1=9,decrypt,c1=d⊕e1=0⊕9=9c1=d⊕e1=0⊕9=9,reparenting,u1v1u1v1,99-th,element,ll,u1v1=35u1v1=35,update,dd,0+21⋅u1+31⋅v1%109+7=210+21⋅u1+31⋅v1%109+7=21,remove,list,ll,save,space,show,ll,removal,encrypted,e2=6e2=6,decrypt,c2=21⊕6=19c2=21⊕6=19,reparenting,u2v2u2v2,1919-th,element,ll,2020-th,element,initial,list,update,dd,21+22⋅u2+32⋅v2%109+7=5921+22⋅u2+32⋅v2%109+7=59,remove,ll,e3=35e3=35,c3=59⊕35=24c3=59⊕35=24,u3v3=67u3v3=67,update,dd,59+23⋅u3+33⋅v3%109+7=29659+23⋅u3+33⋅v3%109+7=296,remove,ll,e4=313e4=313,c4=296⊕313=17c4=296⊕313=17,u4v4=43u4v4=43,update,dd,296+24⋅u4+34⋅v4%109+7=603296+24⋅u4+34⋅v4%109+7=603,remove,ll,chef's,encrypted,choices,e5=602e5=602,c5=603⊕602=1c5=603⊕602=1,u5v5=21u5v5=21,update,dd,603+25⋅u5+35⋅v5%109+7=910603+25⋅u5+35⋅v5%109+7=910,processed,qq,chef's,choices,final,decryption,key,d=910d=910,author,6★ssjgz,editorial,https://discuss.codechef.com/problems/MVCN2TST,tags,trees,disjoint,set,union,persistent,segment,trees,dfs,binary,search,prefix,sum,data,structures,graphs,advanced,data,structures,persistent,structures,algorithms,graph,algos,traversals,searching,simple,algos,difficulty,rating,date,added,30-07-2020,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit