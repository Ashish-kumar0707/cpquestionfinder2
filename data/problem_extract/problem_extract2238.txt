read,problems,statements,hindi,mandarin,chinese,russian,vietnamese,bengali,ayush,rooted,trees,nn,vertices,numbered,nn,denote,vertex,vv,tree,v1v1,vertex,vv,tree,v2v2,tree,tt,vertex,path,root,vertex,vtvt,including,vtvt,ancestor,vtvt,depth,vtvt,distance,vtvt,root,tree,tt,integer,ww,1≤w≤n1≤w≤n,vertices,u1u1,v2v2,ww,common,ancestor,u1u1,v2v2,tree,w1w1,ancestor,u1u1,tree,w2w2,ancestor,v2v2,depths,vertices,w1w1,w2w2,respective,roots,figure,pair,u1v2=61u1v2=61,common,ancestors,—,vertex,ancestor,depths,ayush,find,maximum,number,common,ancestors,pair,vertices,largest,integer,cc,pair,vertices,u1v2u1v2,possibly,u=vu=v,cc,common,ancestors,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,single,integer,nn,line,nn,space-separated,integers,p1p2…pnp1p2…pn,valid,ii,pipi,parent,vertex,i1i1,−1−1,vertex,i1i1,root,tree,line,nn,space-separated,integers,q1q2…qnq1q2…qn,similarly,valid,ii,qiqi,parent,vertex,i2i2,−1−1,vertex,i2i2,root,tree,output,test,case,print,single,line,integer,—,maximum,number,common,ancestors,pair,u1v2u1v2,constraints,1≤t≤1051≤t≤105,1≤n≤1061≤n≤106,1≤piqi≤n1≤piqi≤n,valid,ii,p1p2…pnp1p2…pn,describe,tree,root,q1q2…qnq1q2…qn,describe,tree,root,sum,nn,test,cases,exceed,sample,input,-1,-1,-1,-1,-1,-1,sample,output,explanation,case,pair,u1v2=1112u1v2=1112,common,ancestor,case,u=1u=1,common,ancestors,vv,case,maximum,number,common,ancestors,u1v2=61u1v2=61,shown,figure,statement,author,4★the_hyp0cr1t3,editorial,https://discuss.codechef.com/problems/TREEANC,tags,trees,lazy,propagation,fenwick,trees,dfs,order,data,structures,graphs,advanced,data,structures,advanced,tree,structures,segment,trees,algorithms,graph,algos,traversals,dfs,difficulty,rating,date,added,21-01-2021,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit