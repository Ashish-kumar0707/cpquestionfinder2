read,problems,statements,hindi,mandarin,chinese,russian,vietnamese,bengali,drd,tired,making,stories,formal,description,problem,set,s={s1s2…sk}s={s1s2…sk},integer,xx,sequence,a1a2…ama1a2…am,define,infinite,sequence,w1w2…w1w2…,valid,ii,wi=ai−1%m+1wi=ai−1%m+1,define,function,fifi,non-negative,integer,ii,f0=xf0=x,i∈si∈s,fi=0fi=0,i≠0i≠0,fi=∑ij=1fi−j⋅wj%109+7fi=∑j=1ifi−j⋅wj%109+7,find,fnfn,input,line,input,space-separated,integers,xx,kk,mm,nn,line,kk,space-separated,integers,s1s2…sks1s2…sk,line,mm,space-separated,integers,a1a2…ama1a2…am,output,print,single,line,integer,fnfn,constraints,0≤x<109+70≤x<109+7,0≤k≤2000≤k≤200,1≤m≤2001≤m≤200,0≤n≤10180≤n≤1018,0≤ai<109+70≤ai<109+7,valid,ii,1≤si≤n1≤si≤n,valid,ii,sample,input,sample,output,author,7★kmaaszraa,editorial,https://discuss.codechef.com/problems/DFNC,tags,matrix,exponentiation,recurrence,relation,mathematics,matrices,matrix,multiplication,algorithms,recursion,difficulty,rating,date,added,14-10-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit