read,problems,statements,mandarin,chinese,russian,vietnamese,cities,chefland,chef,owns,biggest,traffic,company,chefland,chef,built,n-1,bidirectional,roads,cities,i-th,road,connects,city,ai,city,bi,ci,kms,long,travel,cities,roads,people,chef's,vip,card,roads,costs,chefcoin/km,travel,chefs,roads,businessman,named,fehc,chefland,compete,chef's,company,created,traffic,network,n-1,roads,i-th,roads,connects,city,pi,city,qi,length,ri,kms,travel,cities,fehc's,roads,ignoring,chef's,similar,chef,people,fehc's,vip,card,travel,roads,costs,chefcoin/km,travel,fehc's,roads,year's,day,chefland,expected,huge,traffic,flow,people,travelling,celebrate,family,friends,≤,<,≤,person,city,city,achieve,chef,fehc,vip,cards,travel,roads,permitted,cards,chef,fehc,competing,relationship,person,vip,card,person,choose,company,shortercheaper,route,city,city,buy,company's,vip,card,travel,company's,roads,tie,chooses,arbitrary,companythis,affect,answer,problem,m=n*n-1/2,people,travel,year's,day,task,compute,total,amount,chefcoins,spent,input,line,input,single,integer,denoting,number,test,cases,test,case,line,single,integer,denoting,number,cities,chefland,n-1,lines,space-separated,integers,ai,bi,ci,denoting,road,chef's,company,n-1,lines,space-separated,integers,pi,qi,ri,denoting,road,fehc's,company,output,test,case,output,number,denoting,total,amount,chefcoins,spent,travellers,constraints,≤,≤,≤,≤,sum,test,cases,≤,≤,ai,bi,pi,qi,≤,≤,ci,ri,≤,subtask,#1,points,≤,sum,test,cases,≤,subtask,#2,points,≤,<,ai,=,pi,bi,=,qi,ci,=,ri,words,chef's,fehc's,traffic,networks,subtask,#3,points,fehc's,traffic,network,chain,1-2-3--n,subtask,#4,points,original,constraints,sample,input,sample,output,explanation,case,people,person,city,city,chooses,chef's,roads,pays,chefcoin,person,city,city,chooses,fehc's,roads,pays,chefcoin,person,city,city,chooses,chef's,roads,pays,chefcoin,author,7★r_64,editorial,https://discuss.codechef.com/problems/CHEFTRAF,tags,centroid-decomposition,dfs-order,fenwick-tree,hard,lowest-common-ancestor,ltime52,r_64,difficulty,rating,date,added,22-09-2017,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit