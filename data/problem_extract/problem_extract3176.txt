read,problems,statements,mandarin,bengali,hindi,russian,vietnamese,people,walking,tree,nn,nodes,numbered,nn,speed,edge,walk,person,sequence,nodes,u1u2…uku1u2…uk,person,appears,node,u1u1,time,walks,node,u2u2,shortest,path,immediately,reaching,u2u2,walks,node,u3u3,shortest,path,reaching,ukuk,person,disappears,walk,person,sequence,v1v2…vlv1v2…vl,manner,count,times,people,meet,—,words,times,reach,node,including,nodes,walks,time,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,space-separated,integers,nn,kk,ll,n−1n−1,lines,space-separated,integers,pp,qq,describing,edge,node,pp,node,qq,line,kk,space-separated,integers,u1u2…uku1u2…uk,line,ll,space-separated,integers,v1v2…vlv1v2…vl,output,test,case,print,single,line,integer,—,number,times,people,meet,constraints,1≤t≤10001≤t≤1000,2≤nkl≤1052≤nkl≤105,1≤pq≤n1≤pq≤n,1≤ui≤n1≤ui≤n,valid,ii,1≤vi≤n1≤vi≤n,valid,ii,ui≠ui+1ui≠ui+1,valid,ii,vi≠vi+1vi≠vi+1,valid,ii,sum,nn,test,cases,exceed,5⋅1055⋅105,sum,kk,test,cases,exceed,5⋅1055⋅105,sum,ll,test,cases,exceed,5⋅1055⋅105,subtasks,subtask,#1,points,2≤nkl≤1032≤nkl≤103,sum,nn,test,cases,exceed,5⋅1035⋅103,sum,kk,test,cases,exceed,5⋅1035⋅103,sum,ll,test,cases,exceed,5⋅1035⋅103,subtask,#2,points,original,constraints,sample,input,sample,output,author,6★kingofnumbers,editorial,https://discuss.codechef.com/problems/TREEWLK2,tags,trees,case,work,lowest,common,ancestor,binary,lifting,data,structures,graphs,special,algorithms,graph,algos,difficulty,rating,date,added,26-10-2018,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit