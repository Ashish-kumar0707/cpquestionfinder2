read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,sequel,problem,move,coins,couple,twists,alice,bob,playing,board,game,board,tree,tboardtboard,nn,nodes,numbered,nn,game,involves,moving,coins,board,node,rr,1≤r≤n1≤r≤n,define,game,gtboardrgtboardr,rules,initially,copy,tboardtboard,valid,vv,cvcv,coins,node,vv,bob,alice,alternate,turns,alice,plays,turn,current,player,single,coin,node,rr,denote,cc,move,node,lies,path,rr,cc,including,rr,including,cc,player,move,coin,turn,coins,node,rr,player,loses,game,board,figure,r=1r=1,current,player,coin,nodes,coins,node,taking,option,coin,node,move,xx,steps,node,r=1r=1,xx,coin,ends,node,assume,pick,x=2x=2,move,coin,node,end,turn,board,player's,turn,players,play,optimally,bob,elementary,game,theory,quickly,predict,winner,game,unimpressed,alice,harder,task,challenges,find,winner,gtboardrgtboardr,valid,rr,1≤r≤n1≤r≤n,bob,figure,answer,specifically,ww,set,valid,rr,winner,gtboardrgtboardr,bob,calculate,∑r∈w2r∑r∈w2r,modulo,109+7109+7,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,single,integer,nn,n−1n−1,lines,space-separated,integers,uu,vv,denoting,nodes,uu,vv,connected,edge,line,nn,space-separated,integers,c1c2…cnc1c2…cn,output,test,case,print,single,line,integer,―,sum,2r2r,valid,rr,winner,gtboardrgtboardr,bob,modulo,109+7109+7,constraints,1≤t≤10001≤t≤1000,1≤n≤3000001≤n≤300000,1≤uv≤n1≤uv≤n,0≤ci≤160≤ci≤16,valid,ii,sum,nn,test,cases,exceed,subtasks,subtask,#1,points,t≤10t≤10,n≤10n≤10,ci≤6ci≤6,valid,ii,c1+c2+…+cn≤10c1+c2+…+cn≤10,subtask,#2,points,t≤100t≤100,n≤1000n≤1000,subtask,#3,points,original,constraints,sample,input,sample,output,explanation,tree,tboardtboard,undirected,arrows,added,edges,clarity,indicating,directions,coins,moved,rr,node,rr,highlighted,red,case,original,tboardtboard,examine,games,r=123r=123,r=1r=1,alice,turns,winner,turn,moves,move,coin,node,node,node,end,turn,coins,node,rr,meaning,bob,unable,move,coin,turn,alice,winner,playing,optimally,precisely,r=2r=2,bob,revenge,time,alice,initial,moves,move,coin,node,node,move,coin,node,node,case,end,turn,coin,remaining,node,rr,bob,move,coin,rr,leave,alice,moves,turn,r=3r=3,alice,wins,similar,reasoning,r=1r=1,case,winning,move,time,move,coin,node,node,figured,winner,gtboardrgtboardr,valid,rr,turns,bob,wins,game,r=2r=2,answer,22%109+7=422%109+7=4,case,original,tboardtboard,boards,r=123456r=123456,proved,bob,wins,gtboard1gtboard1,gtboard2gtboard2,gtboard3gtboard3,alice,wins,gtboard4gtboard4,gtboard5gtboard5,gtboard6gtboard6,answer,21+22+23%109+7=1421+22+23%109+7=14,author,6★ssjgz,editorial,https://discuss.codechef.com/problems/MOVCOIN2,tags,bitwise-operation,centroid-decomposition,hard,sept20,sprague-grundy,ssjgz,ssjgz,xor,difficulty,rating,date,added,17-04-2020,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit