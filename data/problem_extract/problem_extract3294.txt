read,problems,statements,mandarin,chinese,russian,bengali,cooking,competitions,held,cities,chef,participate,nn,cities,numbered,nn,connected,n−1n−1,roads,city,connected,city,traveling,bit,city,ii,assigned,travel,aiai,city,numbered,xx,travel,city,yy,simple,path,xx,yy,axax,roads,participate,city's,competition,chef,visit,chef,finding,maximum,number,competitions,participate,start,city,visit,city,multiple,times,formally,tree,node,ii,assigned,aiai,find,maximum,number,distinct,nodes,visited,start,node,visit,node,multiple,times,condition,move,node,ii,jj,number,edges,ii,jj,aiai,note,bound,stack,memory,equal,total,memory,limit,gb,due,system,configuration,issue,stack,limit,c++,temporarily,set,8mb,code,requires,larger,stack,limit,include,code,input,format,line,single,integer,tt,number,test,cases,test,cases,follow,line,test,case,single,integer,nn,1≤n≤1051≤n≤105,n−1n−1,lines,integers,uiui,vivi,denoting,road,cities,uiui,vivi,line,nn,space,separated,integers,a1⋅⋅⋅ana1⋅⋅⋅an,output,format,single,line,output,maximum,number,cities,visited,starting,visiting,city,number,times,constraints,1≤t≤1041≤t≤104,1≤n≤1051≤n≤105,1≤uivi≤n1≤uivi≤n,ui≠viui≠vi,1≤ai≤1091≤ai≤109,guaranteed,edges,form,tree,guaranteed,sum,nn,test,cases,exceed,2⋅1052⋅105,sample,input,sample,output,explanation,case,city,chef,move,cities,city,chef,move,city,city,chef,move,city,city,chef,move,city,city,chef,move,city,chef,follow,path,1→3→2→1→4→51→3→2→1→4→5,visit,city,case,chef,follow,path,visit,vertices,eventually,aiai,=,case,chef,follow,path,1→2→4→51→2→4→5,paths,maximum,number,author,6★shikhar7s,tester,5★theoneyouwant,editorial,https://discuss.codechef.com/problems/MAXJMP,tags,trees,directed,acyclic,graphs,centroid,decomposition,dynamic,programming,strongly,connected,components,dfs,data,structures,graphs,directed,graphs,advanced,algorithms,advanced,graph,algos,algorithms,graph,algos,traversals,difficulty,rating,date,added,14-08-2021,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit