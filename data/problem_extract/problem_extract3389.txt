chef,large,orchestra,kitchen,preparing,concert,week,music,score,represented,string,ss,length,nn,note,music,score,represented,lowercase,uppercase,english,letter,values,lowercase,letters,values,uppercase,letters,mm,melodies,numbered,mm,chef,considers,pretty,melodies,valid,ii,ii-th,pretty,melody,represented,string,titi,pretty,cici,aa,good,melodies,valid,ii,ii-th,good,melody,represented,string,pipi,cost,qiqi,modify,chef's,music,score,string,ss,types,operations,apply,choose,note,character,ss,replace,note,cost,operation,absolute,difference,original,replaced,note,cost,replacing,|5−2|=3|5−2|=3,cost,replacing,|24−28|=4|24−28|=4,choose,non-empty,substring,ss,replace,good,melody,necessarily,length,valid,ii,cost,replacing,substring,good,melody,pipi,qiqi,duplicate,substring,―,choose,non-empty,substring,ss,denote,ss,insert,copy,ss,ss,immediately,chosen,occurrence,ss,applying,operation,substring,dc,string,acbdcb,resulting,string,acbdcdcb,cost,operation,rr,apply,operations,order,satisfy,restrictions,apply,operations,apply,operation,type,xx,coins,total,cost,sum,costs,operations,apply,exceed,xx,length,string,ss,exceed,time,define,pretty,chef's,music,score,v=∑mi=1ki⋅civ=∑i=1mki⋅ci,kiki,denotes,number,times,ii-th,pretty,melody,occurs,chef's,music,score,substring,occurrences,overlap,goal,maximise,pretty,chef's,music,score,input,line,input,space-separated,integers,nn,mm,aa,xx,rr,line,single,string,ss,length,nn,denoting,chef's,initial,music,score,mm,lines,follow,ii,1≤i≤m1≤i≤m,ii-th,lines,string,titi,space,integer,cici,aa,lines,follow,ii,1≤i≤a1≤i≤a,ii-th,lines,string,pipi,space,integer,qiqi,output,print,line,single,integer,ll,―,number,operations,apply,print,ll,lines,describing,operations,order,applied,format,depending,types,replace,xx-th,note,indexed,current,music,score,character,cc,cc,lowercase,uppercase,english,letter,replace,substring,ll-th,rr-th,note,inclusive,1≤l≤r1≤l≤r,current,music,score,ii-th,good,melody,duplicate,substring,ll-th,rr-th,note,inclusive,1≤l≤r1≤l≤r,current,music,score,constraints,100≤n≤20000100≤n≤20000,1≤m≤1001≤m≤100,0≤a≤100000≤a≤10000,0≤xr≤1050≤xr≤105,1≤|ti|≤501≤|ti|≤50,valid,ii,0≤|ci|≤1030≤|ci|≤103,valid,ii,1≤|pi|≤201≤|pi|≤20,valid,ii,0≤qi≤1050≤qi≤105,valid,ii,valid,ii,titi,lowercase,uppercase,english,letters,valid,ii,pipi,lowercase,uppercase,english,letters,input,afbbet,bbc,cp,ee,bc,output,explanation,note,sequence,operations,initially,chef's,music,score,afbbet,pretty,operation,cost,|27−32|=5|27−32|=5,music,score,aabbet,pretty,operation,cost,aabaabbet,pretty,operation,cost,aabaabbct,pretty,fourth,operation,cost,aabaabbcp,pretty,end,pretty,music,score,total,cost,scoring,score,test,file,max0v/100max0v/100,vv,pretty,chef's,music,score,applying,chosen,operations,score,submission,sum,scores,test,files,final,pretty,points,final,pretty,−666−666,points,output,invalid,sequence,operations,violates,conditions,verdict,submission,wrong,answer,twenty,test,cases,contest,displayed,score,account,test,files,score,reflects,submission's,performance,25%,5/20,test,files,types,program,non-ac,verdict,test,file,submission's,verdict,non-ac,words,ac,verdict,denotes,program,runs,successfully,test,files,end,contest,score,changed,include,sum,program's,scores,fifteen,test,files,test,generation,process,types,test,files,strings,generated,uniformly,randomly,noted,specifically,uniformly,random,string,length,range,[ab][ab],generated,choosing,length,uniformly,randomly,range,choosing,characters,uniformly,randomly,choices,independent,assume,mm,aa,chosen,manually,type,n=100n=100,q1q2…qarq1q2…qar,generated,uniformly,randomly,range,[0100][0100],pretty,values,generated,uniformly,randomly,range,[−50100][−50100],xx,generated,uniformly,randomly,range,[5001000][5001000],type,n=2000n=2000,|ti|>2|ti|>2,valid,ii,q1q2…qarq1q2…qar,generated,uniformly,randomly,[0300][0300],pretty,values,generated,uniformly,randomly,[0103][0103],xx,generated,uniformly,randomly,range,[104106][104106],type,n=5000n=5000,string,letters,|ti|>4|ti|>4,valid,ii,q1q2…qarq1q2…qar,generated,uniformly,randomly,[05][05],pretty,values,generated,uniformly,randomly,[−103103][−103103],xx,generated,uniformly,randomly,range,[1002000][1002000],type,n=20000n=20000,ss,letter,|ti|≤10|ti|≤10,valid,ii,q1q2…qarq1q2…qar,generated,uniformly,randomly,range,[1200][1200],pretty,values,generated,uniformly,randomly,range,[−102103][−102103],xx,generated,uniformly,randomly,range,[103105][103105],type,n=20000n=20000,|ti|>2|ti|>2,valid,ii,q1q2…qaq1q2…qa,generated,uniformly,randomly,range,[0200][0200],rr,generated,uniformly,randomly,range,[1035⋅104][1035⋅104],pretty,values,generated,uniformly,randomly,range,[−500103][−500103],xx,generated,uniformly,randomly,range,[5⋅103105][5⋅103105],author,4★deluxurous,tags,deluxurous,difficulty,rating,date,added,27-01-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit