read,problems,statements,mandarin,chinese,russian,vietnamese,cherry,discovered,garden,magical,tulips,walk,garden,nodes,connected,n-1,trails,nodes,numbered,trail,connects,nodes,ui,vi,length,li,visit,nodes,starting,node,sequence,trails,magical,tulips,grow,disturbed,node,tulip,growing,peacefully,tulip,withers,fully,grown,fully,grown,tulip,picked,grow,spot,left,undisturbed,contiguous,days,cherry,walk,visits,garden,collect,tulips,beloved,jimma,waiting,window,cherry,pass,number,tulips,collects,day,depends,mood,bored,walking,long,trails,day,dj,cherry,start,node,uj,visit,nodes,reach,taking,trails,length,exceed,kj,pick,fully,grown,tulips,find,process,visit,nodes,fully,grown,tulip,tulips,upset,grow,fully,days,cherry,disturb,cherry,visit,node,day,dj+x,fully,grown,tulip,day,day,d1,nodes,fully,grown,tulips,cherry,school,good,counting,wonders,tulips,collected,cherry,figure,number,tulips,collects,days,visits,garden,input,line,input,integer,denoting,number,test,cases,description,test,cases,line,test,case,single,integer,n-1,lines,describe,edges,i+1th,line,space,separated,integers,ui,vi,li,line,space,separated,integers,lines,describing,days,cherry,visits,garden,jth,line,space,separated,integers,dj,uj,kj,output,test,case,output,lines,jth,line,test,case,number,tulips,cherry,collects,day,dj,constraints,≤,≤,≤,nq,≤,≤,uivi,≤,≤,likj,≤,≤,d1,≤,dj-1,<,dj,≤,≤,≤,subtasks,subtask,=,points,subtask,≤,≤,points,sample,input,sample,output,explanation,case,queries,tulips,days,grow,fully,query,cherry,visit,nodes,trail,3-1,length,greater,nodes,fully,grown,tulips,cherry,picks,tulips,grow,back,day,5+4,cherry,visit,output,query,cherry,visit,trails,length,tulips,grown,back,tulips,days,tulip,output,query,day,tulips,grown,back,cherry,trails,length,greater,collect,tulip,-,tulip,author,6★meteora,tester,4★furko,editorial,https://discuss.codechef.com/problems/TULIPS,tags,disjoint,set,union,lazy,propagation,square,root,decomposition,binary,lifting,observation,advanced,data,structures,advanced,tree,structures,segment,trees,advanced,algorithms,algorithms,graph,algos,lowest,common,ancestor,difficulty,rating,date,added,10-02-2016,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,perl,scala,lua,bash,js,lisp,sbcl,pas,gpc,bf,cloj,caml,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,scm,chicken,pike,scm,qobi,st,nem,submit