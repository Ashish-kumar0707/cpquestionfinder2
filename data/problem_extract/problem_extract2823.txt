nayra,stories,people,receiving,random,trees,birthday,presents,time,received,tree,present,birthday,struggling,day,figure,tree,asked,aryan,gave,problem,tree,nn,vertices,weighted,edges,rooted,vertex,define,guvguv,maximum,weight,edge,shortest,path,vertex,uu,vertex,vv,tree,calculating,guvguv,easy,process,qq,queries,query,kk,distinct,vertices,v1v2…vkv1v2…vk,compute,sum,gg-values,pair,vertices,kk,∑i=1k−1∑j=i+1kgvivj∑i=1k−1∑j=i+1kgvivj,note,input,output,large,fast,input-output,methods,input,format,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,space-separated,integers,nn,qq,denoting,number,vertices,tree,number,queries,line,n−1n−1,space-separated,integers,p2p3…pnp2p3…pn,pipi,parent,vertex,ii,line,n−1n−1,space-separated,integers,w2w3…wnw2w3…wn,wiwi,weight,edge,vertices,ii,pipi,qq,lines,queries,answer,description,qq,queries,ii-th,line,integer,kiki,kiki,distinct,space-separated,integers,v1v2…vkiv1v2…vki,kiki,number,vertices,query,v1v2…vkiv1v2…vki,denote,vertices,output,format,test,print,line,qq,space-separated,integers,ii-th,integers,answer,ii-th,query,constraints,1≤t≤31≤t≤3,10≤n≤10510≤n≤105,1≤pi<i1≤pi<i,1≤wi≤5⋅1061≤wi≤5⋅106,1≤q≤3⋅1041≤q≤3⋅104,10≤ki≤n10≤ki≤n,1≤vi≤n1≤vi≤n,vivi,present,single,query,distinct,guaranteed,sum,kiki,queries,test,cases,single,test,file,exceed,15⋅10615⋅106,guaranteed,sum,qq,test,cases,single,test,file,exceed,3⋅1043⋅104,sample,input,sample,output,sample,input,sample,output,explanation,sample,values,guvguv,tree,query,g14=40g14=40,g15=50g15=50,g16=60g16=60,g45=50g45=50,g46=60g46=60,g56=60g56=60,sum,values,query,g23=30g23=30,g27=70g27=70,g28=80g28=80,g37=70g37=70,g38=80g38=80,g78=80g78=80,sum,values,note,sample,satisfy,constraint,ki≥10ki≥10,present,actual,test,data,added,illustration,author,7★aryanc403,tester,suryaprak_adm,editorial,https://discuss.codechef.com/problems/YATP,tags,trees,disjoint,set,union,auxiliary,tree,data,structures,graphs,advanced,data,structures,advanced,algorithms,advanced,graph,algos,difficulty,rating,date,added,30-11-2021,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit