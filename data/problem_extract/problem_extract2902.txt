read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,dream,abstracts,fabric,spacetime,directed,rooted,tree,arborescence,nn,nodes,numbered,nn,node,root,ii,1≤i≤n−11≤i≤n−1,parent,node,i+1i+1,fifi,edges,tree,directed,root,dream,employs,magical,superpower,adds,mm,directed,edges,tree,resulting,directed,graph,remains,acyclic,dag,call,node,dag,event,call,simple,path,dag,era,dream,considers,pair,events,ijij,plausible,era,event,ii,event,jj,note,i<ji<j,hold,plausible,pair,dream,answer,qq,queries,query,positive,integers,ll,rr,l≤rl≤r,wishes,number,plausible,pairs,events,ijij,l≤i<j≤rl≤i<j≤r,input,line,input,space-separated,integers,nn,mm,line,n−1n−1,space-separated,integers,f1f2…fn−1f1f2…fn−1,mm,lines,follow,lines,space-separated,integers,uu,vv,describing,additional,edge,node,uu,node,vv,line,single,integer,qq,qq,lines,follow,lines,space-separated,integers,ll,rr,describing,query,output,query,print,single,line,integer,―,number,plausible,pairs,ijij,l≤i<j≤rl≤i<j≤r,constraints,2≤n≤3⋅1052≤n≤3⋅105,1≤q≤3⋅1051≤q≤3⋅105,0≤m≤200≤m≤20,1≤fi≤n1≤fi≤n,valid,ii,1≤uv≤n1≤uv≤n,graph,input,acyclic,1≤l≤r≤n1≤l≤r≤n,subtasks,subtask,#1,points,graph,line,―,m=0m=0,permutation,p1p2…pnp1p2…pn,p1=1p1=1,nodes,p1p2…pnp1p2…pn,form,directed,path,tree,subtask,#2,points,m=0m=0,subtask,#3,points,nq≤2⋅105nq≤2⋅105,subtask,#4,points,original,constraints,sample,input,sample,output,author,2★piggydan,editorial,https://discuss.codechef.com/problems/DRE3HGF,tags,feb21,piggydan,super-hard,difficulty,rating,date,added,25-01-2021,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit