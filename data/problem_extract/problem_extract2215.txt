read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,chef,tree,nn,vertices,numbered,nn,tree,rooted,vertex,valid,ii,weight,ii-th,vertex,wiwi,vertex,uu,depth,dd,root,depth,denote,sequence,vertices,path,uu,root,v1v2…vdv1v2…vd,v1=uv1=u,vd=1vd=1,fufu,vector,sequence,wv1wv2…wvdwv1wv2…wvd,ii-th,element,fui=wvifui=wvi,valid,ii,vertices,uu,vv,depth,dd,define,dot,product,fu⋅fv=∑di=1fui⋅fvifu⋅fv=∑i=1dfui⋅fvi,task,answer,qq,queries,query,vertices,uu,vv,depth,find,fu⋅fvfu⋅fv,dot,product,large,compute,modulo,input,line,input,space-separated,integers,nn,qq,line,nn,space-separated,integers,w1w2…wnw1w2…wn,n−1n−1,lines,space-separated,integers,uu,vv,denoting,vertices,uu,vv,connected,edge,qq,lines,follow,lines,space-separated,integers,uu,vv,describing,query,output,query,print,single,line,integer,fu⋅fvfu⋅fv,modulo,constraints,1≤nq≤3⋅1051≤nq≤3⋅105,1≤wi≤1091≤wi≤109,valid,ii,1≤uv≤n1≤uv≤n,query,uu,vv,depth,subtasks,subtask,#1,points,time,limit,nq≤1000nq≤1000,subtask,#2,points,time,limit,seconds,nq≤105nq≤105,subtask,#3,points,time,limit,seconds,original,constraints,sample,input,sample,output,explanation,query,f2=45f2=45,f3=35f3=35,scalar,product,4⋅3+5⋅5=374⋅3+5⋅5=37,query,f4=245f4=245,f5=145f5=145,scalar,product,2⋅1+4⋅4+5⋅5=432⋅1+4⋅4+5⋅5=43,author,4★kobor,editorial,https://discuss.codechef.com/problems/SCALSUM,tags,trees,pre,processing,square,root,decomposition,dfs,queries,data,structures,graphs,advanced,algorithms,algorithms,graph,algos,traversals,difficulty,rating,date,added,17-10-2020,time,limit,-,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit