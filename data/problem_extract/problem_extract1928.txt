order,expand,reach,outer,universe,ensure,universal,peace,mib,decided,expand,offices,established,office,nn,important,planets,universe,base,station,planet,ss,office,intergalactic,teleporter,connects,planet,offices,teleporters,bound,planet's,policy,teleport,planet,due,intergalactic,feuds,planets,divided,kk,alliances,numbered,kk,planet,ii,alliance,belongs,words,sequence,a1a2…ana1a2…an,planet,ii,belongs,alliance,aiai,planet,ii,policy,teleportation,planets,alliances,cost,travel,planet,determined,alliance,destination,planet,formally,cost,reach,planet,belongs,alliance,jj,planet,ii,represented,cijcij,intra-alliance,travel,free,ai=jai=j,cij=0cij=0,planet,ii,forbidden,alliances,alliances,cij=−1cij=−1,alliance,jj,forbidden,travel,planet,ii,mib,bound,follow,intergalactic,rules,limited,funds,government,cheap,decided,find,optimal,travel,planets,base,station,planet,ss,agents,busy,missions,assigned,task,find,minimum-cost,paths,task,mib,input,format,line,consist,space-separated,integers,nn,kk,ss,number,planets,number,alliances,base,planet,second-line,consist,nn,space-separated,integers,representing,aiai,alliance,ithith,planet,nn,lines,consist,kk,space-separated,integers,jthjth,integer,ithith,line,represents,cijcij,cost,travel,planet,ii,alliance,jj,output,format,print,nn,space,separated,integers,ithith,integer,representing,minimal,cost,reach,ithith,planet,base,station,unreachable,planets,print,−1−1,constraints,1≤n≤2∗1041≤n≤2∗104,1≤k≤minn10001≤k≤minn1000,n∗k≤2∗106n∗k≤2∗106,1≤ai≤k1≤ai≤k,−1≤cij≤109−1≤cij≤109,sample,input,-1,-1,-1,-1,sample,output,explanation,belong,component,cost,traveling,in-between,multiple,shortest,paths,4→3→14→5→3→14→3→14→5→3→1,4→14→1,equal,costs,path,4→5→24→5→2,costs,units,similarly,node,cost,units,author,6★hitch_hiker42,tester,4★shivy08,editorial,https://discuss.codechef.com/problems/PLNTPATH,tags,graphs,dijkstra's,algorithm,data,structures,algorithms,graph,algos,shortest,paths,difficulty,rating,date,added,18-07-2021,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit