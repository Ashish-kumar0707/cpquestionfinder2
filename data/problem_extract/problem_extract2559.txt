read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,chef,loves,graphs,express,love,defines,function,fgxyfgxy,undirected,connected,graph,gg,weighted,edges,vertices,xx,yy,fgxyfgxy,defined,minimum,weights,paths,gg,vertices,xx,yy,weight,path,maximum,weights,edges,path,chef,connected,graphs,g1g1,g2g2,graphs,nn,vertices,labelled,nn,mm,edges,calculate,s=∑i=1n−1∑j=i+1nfg1ij⋅fg2ijs=∑i=1n−1∑j=i+1nfg1ij⋅fg2ij,modulo,input,line,input,space-separated,integers,nn,mm,mm,lines,follow,lines,space-separated,integers,uu,vv,ww,denoting,vertices,uu,vv,g1g1,connected,edge,weight,ww,mm,lines,follow,lines,space-separated,integers,uu,vv,ww,denoting,vertices,uu,vv,g2g2,connected,edge,weight,ww,output,print,single,line,integer,—,sum,ss,modulo,constraints,1≤n≤1051≤n≤105,m=2nm=2n,1≤uv≤n1≤uv≤n,1≤w≤1081≤w≤108,g1g1,g2g2,connected,graphs,subtasks,subtask,#1,points,n=2000n=2000,subtask,#2,points,n=105n=105,g1g1,g2g2,identical,graphs,subtask,#3,points,original,constraints,sample,input,sample,output,author,6★nqiiii,editorial,https://discuss.codechef.com/problems/MXMN,tags,centroid,decomposition,auxiliary,tree,advanced,algorithms,advanced,graph,algos,difficulty,rating,date,added,14-06-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit