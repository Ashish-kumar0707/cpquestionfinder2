read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,chef,tree,nn,nodes,numbered,nn,node,denote,node,ii,vivi,chef,likes,travel,tree,pair,nodes,uvuv,defines,score,path,uu,vv,suppose,simple,path,node,uu,node,vv,sequence,nodes,u=a0a1…al=vu=a0a1…al=v,ll,length,path,denote,values,nodes,path,sequence,a0a1…ala0a1…al,valid,ii,ai=vaiai=vai,denote,suffix,sums,sequence,aa,s0s1…sls0s1…sl,valid,ii,si=∑lj=iajsi=∑j=ilaj,score,fuvfuv,path,node,uu,node,vv,sum,suffix,sums,fuv=∑li=0sifuv=∑i=0lsi,chef,choose,nodes,uu,vv,u≠vu≠v,travel,simple,path,uu,vv,treat,consecutive,paths,affects,score,resulting,trip,specifically,simple,path,node,uu,node,vv,sequence,nodes,u=a0a1…al=vu=a0a1…al=v,chef,choose,non-negative,integer,mm,sequence,k1k2…kmk1k2…km,1≤k1<k2<…km<l1≤k1<k2<…km<l,score,trip,uu,vv,fuak1+fak1ak2+…+fakmvfuak1+fak1ak2+…+fakmv,specifically,m=0m=0,score,trip,simply,fuvfuv,find,maximum,score,chef's,trip,nodes,uu,vv,u≠vu≠v,sequence,kk,chosen,optimally,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,single,integer,nn,line,nn,space-separated,integers,v1v2…vnv1v2…vn,n−1n−1,lines,follow,lines,space-separated,integers,aa,bb,denoting,nodes,aa,bb,connected,edge,output,test,case,print,single,line,integer,―,maximum,score,constraints,1≤t≤1001≤t≤100,2≤n≤3⋅1052≤n≤3⋅105,|vali|≤105|vali|≤105,valid,ii,1≤ab≤n1≤ab≤n,graph,input,tree,sum,nn,test,cases,exceed,3⋅1053⋅105,subtasks,subtask,#1,points,sum,nn,test,cases,exceed,subtask,#2,points,original,constraints,input,-10,ouput,-2,explanation,case,f12=−6f12=−6,f21=−18f21=−18,f13=−2f13=−2,f31=−16f31=−16,f23=−6f23=−6,f32=−10f32=−10,trip,node,node,split,paths,2→1→32→1→3,score,−20−20,trip,node,node,split,paths,3→1→23→1→2,score,−22−22,trip,treated,path,maximum,score,−2−2,trip,node,node,author,5★sajib_readd,editorial,https://discuss.codechef.com/problems/JMPFVR,tags,trees,dsu,trees,convex,hull,dfs,data,structures,graphs,advanced,algorithms,advanced,graph,algos,computational,geometry,polygons,algorithms,graph,algos,traversals,difficulty,rating,date,added,20-04-2020,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit