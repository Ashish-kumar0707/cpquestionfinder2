read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,chef,happy,today,offer,gordon,ramsay,work,london,chef,prepare,delicious,cake,gordon,impress,gordon,ramsay,easy,impress,gordon,cut,chef's,cake,small,slices,numbered,row,valid,slices,i+1,adjacent,note,slices,adjacent,valid,i-th,slice,taste,ai,gordon,put,special,toppings,slices,chef,group,slices,clusters,slices,cluster,form,contiguous,sequence,sweetness,cake,maximum,valid,denote,topping,i-th,slice,ti,ti=0,topping,slice,sweetness,slice,ti⋅ai,sweetness,slice,special,topping,sweetness,cluster,total,summed,sweetness,slices,cluster,denote,sweetnesses,clusters,s1s2…sk,sweetness,cake,computed,s1∗s2∗…∗sk,operation,∗,defined,non-negative,integers,x≥y,x∗y=y∗x=⌊log2x⌋∑n=02n⌊x2n⌋mod2⌊y2n⌋mod2,proven,operation,associative,x∗y∗z=x∗y∗z,answer,queries,query,toppings,slices,number,clusters,chef,maximum,sweetness,cake,input,line,input,single,integer,line,space-separated,integers,a1a2…an,line,single,integer,query,lines,follow,lines,single,integer,line,space-separated,integers,t1t2…tn,output,print,single,line,integer,—,maximum,sweetness,constraints,1≤q≤10,1≤n≤105,1≤k≤105,1≤ai≤1015,valid,0≤ti≤10,valid,query,number,slices,toppings,exceed,subtasks,subtask,#1,points,original,constraints,sample,input,sample,output,explanation,query,chef,choose,clusters,cluster,slices,cluster,slices,cluster,slices,sweetness,cake,15⋅2+5⋅3∗26⋅1+4⋅4+3⋅7+13⋅1+5⋅5∗5⋅1+27⋅1+11⋅1=33,author,5★utkarsh97,editorial,https://discuss.codechef.com/problems/CHEFOFR,tags,dp,bitmask,bitwise,operation,dynamic,programming,binary,search,advanced,algorithms,advanced,dp,mathematics,bit,manipulation,algorithms,searching,difficulty,rating,date,added,23-01-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit