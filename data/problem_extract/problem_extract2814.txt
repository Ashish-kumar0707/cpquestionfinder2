city,chefland,metro,network,nn,stations,metro,tunnels,pairs,stations,budget,tight,construction,nn,stations,connected,n−1n−1,tunnels,station,reachable,station,initially,constructed,tight,budget,surprise,fallen,disrepair,time,chef,mayor,chefland,secured,kk,dollars,renovating,metro,stations,metro,station,ithith,station,requires,aiai,dollars,renovate,stations,directly,connected,ithith,station,renovated,share,resources,stations,cost,renovating,ithith,station,drops,bibi,dollars,chef,figure,maximum,number,stations,renovate,kk,dollars,input,line,tt,number,test,cases,tt,cases,follow,line,test,case,integers,nn,kk,line,nn,integers,a1a2…ana1a2…an,line,nn,integers,b1b2…bnb1b2…bn,n−1n−1,lines,follow,pair,integers,uu,vv,denoting,uthuth,vthvth,stations,connected,tunnel,output,testcase,output,single,line,maximum,number,stations,renovated,constraints,1≤t≤2001≤t≤200,2≤n≤50002≤n≤5000,1≤k≤10121≤k≤1012,1≤bi<ai≤1081≤bi<ai≤108,1≤uv≤n1≤uv≤n,u≠vu≠v,sum,nn,test,cases,exceed,sample,input,sample,output,explanation,case,renovating,station,costs,a1=5a1=5,renovating,station,costs,a2=10a2=10,renovating,costs,b1+b2=3+3=6b1+b2=3+3=6,station,renovated,dollars,case,stations,renovated,total,cost,a1+b3+b4=5+2+2=9a1+b3+b4=5+2+2=9,stations,renovated,dollars,renovate,stations,dollars,case,stations,renovated,cost,b1+b2+b3+b5+b6=3+1+2+4+3=13b1+b2+b3+b5+b6=3+1+2+4+3=13,stations,renovated,dollars,author,6★meooow,editorial,https://discuss.codechef.com/problems/CLMTRO,tags,trees,dp,trees,dfs,data,structures,graphs,advanced,algorithms,advanced,dp,algorithms,graph,algos,traversals,difficulty,rating,date,added,4-02-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit