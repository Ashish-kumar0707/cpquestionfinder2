chef,collecting,special,ingredients,cave,cave,nn,chambers,n−1n−1,passageways,forming,tree,words,move,chamber,chamber,passageways,passageway,equal,length,traversed,directions,00-th,chef,chamber,ajaj,start,choose,stay,current,chamber,move,passageway,chamber,collect,ingredients,visit,distinct,chambers,leaving,cave,chamber,bjbj,ghost,copies,chef's,movement,delay,kjkj,seconds,means,kjkj-th,ghost,cave,kjkj-th,ghost,appears,chamber,ajaj,tt-th,t≥kjt≥kj,ghost,place,chef,t−kjt−kj-th,ghost,capture,chef,moment,time,chamber,passageway,including,moment,chef,leave,chamber,bjbj,start,chamber,ajaj,end,chamber,bjbj,ghost,movement,delay,kjkj,chef,determine,maximum,number,distinct,chambers,visit,answer,qq,queries,cave,input,format,line,space-separated,integers,nn,qq,representing,number,chambers,queries,n−1n−1,lines,space-separated,integers,uiui,vivi,representing,endpoints,passageway,qq,lines,space-separated,integers,ajaj,bjbj,kjkj,representing,start,chamber,end,chamber,ghost's,movement,delay,query,output,format,query,output,single,line,maximum,number,distinct,chambers,chef,visit,constraints,2≤n≤2⋅1052≤n≤2⋅105,1≤q≤2⋅1051≤q≤2⋅105,1≤uivi≤n1≤uivi≤n,chambers,passageways,form,tree,1≤ajbj≤n1≤ajbj≤n,1≤kj≤1091≤kj≤109,subtasks,subtask,points,chamber,connected,passageways,subtask,points,k=1k=1,queries,subtask,points,2≤n≤50002≤n≤5000,1≤q≤50001≤q≤5000,subtask,points,original,constraints,sample,input,sample,output,explanation,graph,sample,test,case,query,table,describes,move,visit,chambers,notice,chef,choose,stay,chamber,shown,visit,chambers,time,chefs,position,ghosts,position,–,–,–,–,author,4★cstuart,tester,7★aryanc403,tags,trees,disjoint,set,union,lowest,common,ancestor,dfs,data,structures,graphs,advanced,data,structures,algorithms,graph,algos,traversals,difficulty,rating,date,added,25-11-2021,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit