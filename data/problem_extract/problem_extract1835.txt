maui,undirected,connected,graph,g=veg=ve,vv,=,{v1v2…vnv1v2…vn},ee,edge,set,list,positive,non-zero,integers,a1a2…ana1a2…an,bored,usual,adventures,decided,build,directed,graph,g′=ufg′=uf,uu,=,{u1u2…unu1u2…un},uiuj∈fuiuj∈f,walk,length,aiai,vivi,vjvj,gg,note,walk,repeat,edges,noticed,directed,graph,g′g′,vertices,uiui,ujuj,path,uiui,ujuj,g′g′,note,pairs,vertices,maui,lost,list,integers,graph,gg,constructing,list,satisfy,property,mentioned,state,input,line,input,integers,nmnm,represent,number,nodes,edges,gg,i-th,mm,lines,numbers,ii,jj,signify,undirected,edge,vivjvivj,exists,gg,output,list,integers,satisfies,property,exists,print,line,nn,integers,order,line,integers,satisfy,1≤ai≤1091≤ai≤109,exist,print,constraints,2≤n≤1002≤n≤100,1≤m≤n∗n−121≤m≤n∗n−12,1≤ij≤n1≤ij≤n,input,graph,connected,multi-edges,self-loops,subtasks,points,2≤n≤152≤n≤15,points,input,graph,bi-partite,points,constraints,sample,input,sample,output,explanation,output,a1=2a1=2,direct,edge,u1u1,u2u2,walk,length,v1v1,v2v2,walk,walk,length,v1v1,v3v3,direct,edge,u1u1,u3u3,g′g′,similarly,check,edge,set,g′g′,{u1u3u3u1u2u1u2u3u1u3u3u1u2u1u2u3},notice,path,u1u1,u2u2,g′g′,valid,output,author,admin3,tags,admin3,difficulty,rating,date,added,24-06-2018,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit