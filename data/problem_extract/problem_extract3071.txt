read,problem,statements,bengali,mandarin,chinese,russian,vietnamese,madoka,tree,coming,age,simple,rooted,tree,nn,vertices,root,vertex,number,i≥2i≥2,pipi,1≤pi≤i−11≤pi≤i−1,parent,vertex,ii,define,depth,array,hh,h1=1h1=1,hi=hpi+1hi=hpi+1,i≥2i≥2,subtree,vertex,uu,denoted,susu,defined,set,vertices,vv,unique,path,vv,uu,define,valu=max{hvv∈su}valu=max{hvv∈su},tree,divided,paths,ladder,decomposition,vertex,located,path,vertex,uu,child,lies,path,child,vv,maximum,valvvalv,vertices,vertex,minimum,number,selected,madoka,defines,beauty,tree,ladder,decomposition,path,lengths,l1…lkl1…lk,beauty,tree,l21+l22+⋯+l2kl12+l22+⋯+lk2,ii,1≤i≤n1≤i≤n,task,calculate,beauty,tree,formed,ii,vertices,input,line,integer,tt,-,number,test,cases,tt,test,cases,follow,line,test,case,single,integer,nn,-,size,tree,line,n−1n−1,integers,p2…pnp2…pn,output,test,case,print,separate,line,single,integer,-,answer,problem,constraints,1≤t≤101≤t≤10,2≤n≤8⋅1052≤n≤8⋅105,1≤pi<i1≤pi<i,2≤i≤n2≤i≤n,sum,nn,test,cases,8⋅1058⋅105,subtasks,subtask,points,sum,nn,2⋅1032⋅103,time,limit,subtask,points,hi≤3hi≤3,ii,sum,nn,time,limit,subtask,points,sum,nn,2⋅1052⋅105,time,limit,subtask,points,original,constraints,time,limit,seconds,sample,input,sample,output,explanation,author,5★fairy_winx,editorial,https://discuss.codechef.com/problems/LADCOMP,tags,trees,sets,lowest,common,ancestor,dfs,euler,tour,data,structures,graphs,algorithms,graph,algos,traversals,difficulty,rating,date,added,28-06-2021,time,limit,-,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit