permutation,length,nn,array,nn,integers,integer,nn,inclusive,appears,chef,creates,set,permutation,p1p2…pnp1p2…pn,length,nn,initially,chef,takes,empty,set,s=ϕs=ϕ,index,i1≤i≤ni1≤i≤n,chef,insert,pair,integers,liriliri,ss,1≤li≤ri≤n1≤li≤ri≤n,plipli+1…priplipli+1…pri,denotes,longest,subsegment,permutation,pipi,maximum,element,note,elements,set,ss,distinct,pairs,liriliri,ljrjljrj,li=ljli=lj,ri=rjri=rj,permutation,chef,creates,set,s={11121444}s={11121444},set,tt,nn,distinct,pairs,integers,find,number,permutations,length,nn,chef,create,set,ss,equivalent,set,tt,number,large,print,modulo,109+7109+7,sets,ss,tt,considered,equivalent,∣s∣=∣t∣∣s∣=∣t∣,∣s∣∣s∣,denotes,size,set,ss,element,ss,present,tt,liri∈sliri∈tliri∈sliri∈t,note,elements,set,tt,order,input,format,line,input,integer,tt,denoting,number,test,cases,tt,test,cases,follow,line,test,case,single,integer,nn,denoting,size,set,tt,nn,lines,pair,integers,liriliri,denoting,set,tt,output,format,test,case,output,single,line,number,valid,permutations,modulo,109+7109+7,constraints,1≤t≤1051≤t≤105,1≤n≤2⋅1051≤n≤2⋅105,1≤li≤ri≤n1≤li≤ri≤n,valid,ii,liri≠ljrjliri≠ljrj,i≠ji≠j,sum,nn,test,cases,exceed,2⋅1052⋅105,sample,input,sample,output,explanation,test,case,permutations,length,[12][12],generates,set,s={1112}s={1112},equivalent,t={2212}t={2212},[21][21],generates,set,s={1222}s={1222},equivalent,t={2212}t={2212},test,case,permutation,length,generate,set,equivalent,t={331322}t={331322},test,case,valid,permutations,[24531][24531],[14532][14532],[12543][12543],[12345][12345],valid,permutation,generates,set,s={1112131415}s={1112131415},equivalent,set,tt,author,5★soumyadeep_21,editorial,https://discuss.codechef.com/problems/HIDPERM,tags,binary-search,easy-medium,recursion,soumyadeep_21,start25,difficulty,rating,date,added,4-02-2022,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit