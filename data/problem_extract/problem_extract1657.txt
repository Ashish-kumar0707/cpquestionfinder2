read,problems,statements,mandarin,chinese,russian,vietnamese,gears,numbered,valid,gear,ai,teeth,beginning,gear,connected,task,process,queries,simulate,gears,mechanism,types,queries,type,change,number,teeth,gear,type,connect,gears,type,find,speed,rotation,gear,gear,rotates,speed,gear,directly,connected,gear,gear,rotates,speed,gear,rotate,speed,−vai/aj,sign,rotation,speed,denotes,direction,rotation,minus,denotes,rotation,opposite,direction,notice,gears,blocked,cases,gear,rotate,directions,gear,connected,blocked,gear,blocked,gears,connected,configuration,rotate,connect,fourth,gear,blocked,rotate,input,line,input,space-separated,integers,line,space-separated,integers,a1a2…an,lines,describe,queries,lines,begins,integer,denoting,type,current,query,t=1,space,space-separated,integers,t=2,space,space-separated,integers,t=3,space,space-separated,integers,output,query,type,print,single,line,integers,separated,slash,/,—,numerator,denominator,rotation,speed,gear,expressed,irreducible,fraction,speed,integer,gear,rotate,constraints,1≤n≤105,1≤m≤2⋅105,6≤ai≤106,valid,1≤xy≤n,1≤cv≤106,subtasks,subtask,#1,points,n≤2000,m≤5000,subtask,#2,points,original,constraints,sample,input,sample,output,-9/4,7/1,explanation,query,type,connections,gears,answer,query,type,calculate,rotation,speed,formula,−3⋅68=−94,query,type,formula,speed,gear,−10⋅78=−354,speed,gear,−−354810=71,query,type,gears,blocked,author,3★andreab3301,editorial,https://discuss.codechef.com/problems/GEARS,tags,disjoint,set,union,bipartite,observation,implementation,advanced,data,structures,algorithms,graph,algos,coloring,difficulty,rating,date,added,30-06-2018,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit