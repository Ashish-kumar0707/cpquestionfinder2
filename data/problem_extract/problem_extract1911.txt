read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,chef,adventure,find,tastiest,exotic,spices,spices,guarded,ancient,dragons,dwell,mountains,mountain,range,modeled,polyline,2d,xzxz,plane,passes,nn,points,p1=1h1p2=2h2…pn=nhnp1=1h1p2=2h2…pn=nhn,order,hihi,positive,integer,valid,polyline,divides,set,points,{xz1≤x≤n},regions,solid,part,mountain,range,bottom,region,region,x-axis,x-axis,line,z=0,dragon's,den,located,points,valid,den,point,pi,initially,pile,spices,tastiness,ai,technique,learned,dragons,chef,glide,den,den,tasting,spices,tastiness,entire,journey,summed,tastiness,spices,dens,visited,journey,restrictions,chef,glide,higher,den,strictly,lower,den,glides,den,pi,den,pj,hi>hj,hold,chef,glide,direction,back,starts,travelling,direction,decreasing,travelling,direction,end,journey,starts,travelling,direction,increasing,travelling,direction,end,journey,chef,travel,solid,mountain,glide,den,pi,den,pj,line,segment,connecting,points,pi,pj,intersect,solid,part,mountain,range,touch,border,mountain,range,polyline,note,gliding,chef,travel,dens,valid,journey,begin,end,den,case,chef,tastes,spices,den,explanation,sample,test,case,concrete,mind,chef,process,queries,types,queries,chef,mind,decides,tastiness,spices,den,point,pb,changed,chef,start,journey,den,located,pb,end,den,located,pc,find,maximum,tastiness,journey,determine,journey,exists,input,line,input,space-separated,integers,line,space-separated,integers,h1h2…hn,line,space-separated,integers,a1a2…an,lines,follow,lines,space-separated,integers,describing,query,format,output,query,type,print,single,line,integer,―,maximum,tastiness,journey,−1,valid,journey,exists,constraints,1≤nq≤2⋅105,1≤hi≤109,valid,1≤ai≤109,valid,1≤bc≤n,1≤k≤109,subtasks,subtask,points,nq≤1000,subtask,points,queries,type,subtask,points,original,constraints,sample,input,sample,output,-1,explanation,illustration,mountain,range,sample,test,case,query,starting,p5,height,chef,glide,p3,height,p2,height,total,tastiness,journey,a5+a3+a2=16+4+2=22,query,a3,set,query,chef,glides,p3,p4,tastiness,a3+a4=5+8=13,query,impossible,p1,p4,h1>h4,reach,p4,chef,fly,upwards,mountain,impossible,author,3★shisuko,editorial,https://discuss.codechef.com/problems/DRGNDEN,tags,stacks,trees,segment,trees,fenwick,trees,hld,dfs,order,data,structures,graphs,advanced,data,structures,advanced,tree,structures,advanced,algorithms,advanced,graph,algos,algorithms,graph,algos,traversals,dfs,difficulty,rating,date,added,23-03-2020,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit