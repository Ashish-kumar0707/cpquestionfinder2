read,problems,statements,mandarin,chinese,russian,vietnamese,chef,tree,weighted,nodes,day,decided,trees,removed,edges,day,decided,trees,removed,edge,trees,day,chef,removing,removed,edge,util,forest,consisting,single-node,trees,chef,thinks,main,characteristic,tree,diameter,asks,calculate,product,diameters,obtained,set,trees,product,large,output,modulo,109+7,note,problem,diameter,tree,maximum,sum,weights,nodes,simple,paths,tree,input,line,input,integer,denoting,number,nodes,tree,line,space-separated,integers,wi,denoting,weights,nodes,n-1,lines,space-separated,integers,xi,yi,n-1,lines,single,integer,kj,denoting,number,edge,deleted,jth,day,output,output,lines,ith,line,output,product,diameters,trees,i-1,days,modulo,109+7,formally,>,output,product,diameters,obtained,trees,deleting,edges,k1,k2,ki,-,modulo,109+7,output,diameter,initial,tree,constraints,≤,≤,≤,wi,≤,≤,xi,yi,≤,permutation,integers,range,[1,n-1],subtasks,subtask,#1,points,≤,≤,subtask,#2,points,≤,≤,subtask,#3,points,additional,constraints,input,output,explanation,diameter,initial,tree,node,node,node,day,deletion,2nd,edge,trees,diameters,day,deletion,1st,edge,trees,diameters,product,equals,author,sergey_adm,tester,4★harshil7924,editorial,https://discuss.codechef.com/problems/TREEDIAM,tags,trees,disjoint,set,union,lowest,common,ancestor,dfs,diameter,data,structures,graphs,advanced,data,structures,algorithms,graph,algos,traversals,graph,measurements,difficulty,rating,date,added,6-08-2016,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,perl,scala,lua,bash,js,lisp,sbcl,pas,gpc,bf,cloj,caml,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,scm,chicken,pike,scm,qobi,st,nem,submit