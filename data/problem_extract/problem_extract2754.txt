read,problems,statements,mandarin,chinese,russian,tree,nodes,numbered,handle,queiries,types,+,add,path,node,node,irrelevant,add,path,present,-,delete,path,node,node,guaranteed,path,exists,adding,deleted,root,tree,node,present,added,deleted,path,common,ancestor,endpoints,endpoints,path,call,node,root,output,product,roots,indexes,query,input,line,input,single,space,separated,integers,-,number,nodes,tree,number,queries,n-1,lines,pairs,integers,denoting,edges,tree,pair,corresponds,edge,nodes,lines,denoting,queries,form,output,output,lines,output,product,roots,numbers,modulo,109+7,performing,i-th,query,i-th,line,roots,output,-1,line,constraints,≤,≤,≤,≤,≤,≤,-,points,≤,≤,-,points,input,+,+,-,-,output,author,sergey_adm,tester,6★stzgd,editorial,https://discuss.codechef.com/problems/TROOT,tags,trees,segment,trees,dfs,data,structures,graphs,advanced,data,structures,advanced,tree,structures,algorithms,graph,algos,traversals,difficulty,rating,date,added,30-04-2014,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,text,pas,fpc,nodejs,ruby,php,hask,tcl,perl,scala,lua,bash,js,lisp,sbcl,pas,gpc,bf,cloj,caml,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,pike,scm,qobi,st,nem,submit