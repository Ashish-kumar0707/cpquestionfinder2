tyrion,learning,game,theory,impress,queenlord,varys,wanted,test,learning,tyrion,presented,problem,min-max,tyrion,solving,problem,tree,nn,nodes,rooted,node,node,uu,tree,pair,values,aubuaubu,find,result,rr,r=∑u=1n∑v=1nfuvr=∑u=1n∑v=1nfuv,fuv={minmaxauavmaxbubv0ifvliesinsubtreeofuotherwisefuv={minmaxauavmaxbubvifvliesinsubtreeofu0otherwise,input,line,integer,nn,denoting,number,nodes,tree,line,nn,space,separated,integers,a1a2a3ana1a2a3an,line,nn,space,separated,integers,b1b2b3bnb1b2b3bn,n−1n−1,lines,space,separated,integers,uu,vv,denoting,edge,node,uu,vv,output,output,single,line,result,rr,constraints,1≤n≤1051≤n≤105,1≤a[i]b[i]≤1091≤a[i]b[i]≤109,1≤uv≤n1≤uv≤n,u≠vu≠v,sample,input,sample,output,explanation,f11=minmaxa1a1maxb1b1=1f11=minmaxa1a1maxb1b1=1,f12=minmaxa1a2maxb1b2=4f12=minmaxa1a2maxb1b2=4,f13=minmaxa1a3maxb1b3=5f13=minmaxa1a3maxb1b3=5,f14=minmaxa1a4maxb1b4=2f14=minmaxa1a4maxb1b4=2,f15=minmaxa1a5maxb1b5=3f15=minmaxa1a5maxb1b5=3,f22=minmaxa2a2maxb2b2=2f22=minmaxa2a2maxb2b2=2,f24=minmaxa2a4maxb2b4=2f24=minmaxa2a4maxb2b4=2,f25=minmaxa2a5maxb2b5=3f25=minmaxa2a5maxb2b5=3,f33=minmaxa3a3maxb3b3=4f33=minmaxa3a3maxb3b3=4,f44=minmaxa4a4maxb4b4=1f44=minmaxa4a4maxb4b4=1,f55=minmaxa5a5maxb5b5=3f55=minmaxa5a5maxb5b5=3,rest,fuvfuv,listed,rr,=,+,+,+,+,+,+,+,+,+,+,=,result,author,4★aashu_k,tags,fenwick,trees,dfs,binary,search,advanced,data,structures,advanced,tree,structures,algorithms,graph,algos,traversals,searching,difficulty,rating,date,added,31-03-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit