read,problem,statements,mandarin,bengali,russian,vietnamese,grid,nn,rows,mm,columns,kk,cannons,numbered,kk,kk,cells,grid,cannon,fire,ball,cell,manhattan,distance,cannon,exceed,strength,cannon,including,cell,cannon,initially,00-th,strengths,cannons,increase,starting,00-th,cannons,start,throwing,balls,rules,cannon,fires,ball,cell,balls,note,cell,exists,cannon,grid,full,cannon,fire,multiple,seconds,ball,fired,cannon,ii-th,number,ii,printed,cell,ball,lands,end,n⋅m−1n⋅m−1,grid,representing,permutation,integers,n⋅m−1n⋅m−1,permutations,p1p1,p2p2,cell,numbers,printed,p1p1,p2p2,permutation,considered,good,formed,end,n⋅m−1n⋅m−1,process,task,find,fraction,permutations,good,number,good,permutations,divided,number,permutations,n⋅m−1n⋅m−1,denote,fraction,p/qp/q,pp,qq,positive,integers,qq,coprime,compute,p⋅q−1p⋅q−1,modulo,q−1q−1,denotes,multiplicative,inverse,qq,modulo,note,manhattan,distance,cell,row,r1r1,column,c1c1,cell,row,r2r2,column,c2c2,|r1−r2|+|c1−c2||r1−r2|+|c1−c2|,input,format,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,space-separated,integers,nn,mm,kk,kk,lines,follow,valid,ii,ii-th,lines,space-separated,integers,riri,cici,—,row,column,ii-th,cannon,located,output,format,test,case,print,single,line,integer,p⋅q−1p⋅q−1,modulo,constraints,1≤t≤10001≤t≤1000,1≤nm≤500001≤nm≤50000,1≤k≤minn⋅m10001≤k≤minn⋅m1000,1≤ri≤n1≤ri≤n,valid,ii,1≤ci≤m1≤ci≤m,valid,ii,sum,kk,test,cases,exceed,sum,nn,test,cases,exceed,sum,mm,test,cases,exceed,subtasks,subtask,#1,points,1≤n⋅m≤1061≤n⋅m≤106,sum,n⋅mn⋅m,test,cases,exceed,subtask,#2,points,original,constraints,sample,input,sample,output,author,4★vanshkaul,editorial,https://discuss.codechef.com/problems/MATPERM,tags,difference,arrays,permutations,combinations,sorting,prefix,sum,manhattan,distance,data,structures,arrays,mathematics,combinatorics,algorithms,simple,algos,difficulty,rating,date,added,29-07-2021,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit