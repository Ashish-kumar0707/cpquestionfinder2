read,problems,statements,mandarin,chinese,russian,vietnamese,takaki,tono,computer,programmer,tokyo,boss,work,shows,online,puzzle,solved,earn,solver,full,expense,paid,trip,los,angeles,california,takaki,solve,love,life,akari,lives,los,angeles,met,years,reading,puzzle,realizes,query,based,problem,problem,-,tree,nodes,numbered,node,numbered,positive,integer,az,written,integer,denotes,node,process,queries,forms,-,report,closest,values,unique,path,compute,min|ap,-,aq|,distinct,nodes,unique,path,report,farthest,values,unique,path,compute,max|ap,-,aq|,distinct,nodes,unique,path,mentioned,equal,query,nodes,printed,|x|,denotes,absolute,takaki,perplexed,requires,solve,task,input,line,input,integer,denoting,number,nodes,tree,line,comprises,space,separated,integers,denoting,i-th,integer,denotes,ai,n-1,lines,comprise,space,separated,integers,denoting,node,node,connected,edge,guaranteed,final,graph,connected,tree,line,single,integer,denoting,number,queries,lines,comprise,queries,line,format,output,query,print,required,output,mentioned,constraints,≤,≤,≤,ai,≤,≤,≤,≤,≤,nodes,printed,equal,query,subtasks,subtasks,subtask,#1,points,≤,subtask,#2,points,type,queries,present,subtask,#3,points,original,constraints,input,output,explanation,tree,sample,input,node,numbers,written,number,represents,node,index,number,node,author,6★animesh_f,tester,4★pushkarmishra,editorial,https://discuss.codechef.com/problems/CLOSEFAR,tags,segment,trees,square,root,decomposition,coordinate,compression,euler,tour,binary,lifting,advanced,data,structures,advanced,tree,structures,advanced,algorithms,pre,processing,algorithms,graph,algos,traversals,lowest,common,ancestor,difficulty,rating,date,added,29-07-2016,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,perl,scala,lua,bash,js,lisp,sbcl,pas,gpc,bf,cloj,caml,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,scm,chicken,pike,scm,qobi,st,nem,submit