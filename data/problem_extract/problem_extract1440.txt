read,problems,statements,mandarin,chinese,russian,vietnamese,cooking,community,chef,big,fan,chefgram™,—,social,network,chefs,cooks,upload,secret,kitchen,photos,recently,chef,clicked,beautiful,photo,represented,pixels,single,row,respecting,chefgram™'s,boolean,roots,pixel,white,black,chefgram™,filters,filter,string,symbols,symbol,+,-',+,ith,position,filter,means,chef,applies,filter,photo,ith,pixel,inverted,black,originally,white,vice,versa,-,ith,position,filter,string,means,chef,applies,filter,photo,ith,pixel,remain,unchanged,chef,apply,filters,list,pick,subset,filters,apply,photo,imagine,chef,photo,bbwwbbwwbb,stands,black,stands,white,applies,filters,++--++--++,-+-+-+-+-+,applying,filter,transform,picture,wwwwwwwwww,applying,filter,transformed,picture,give,chef,picture,wbwbwbwbwb,chefgram™,identical,filters,considered,chef,extremely,interested,knowing,subsets,chefgram™,filters,apply,transform,photo,black,pixels,input,line,input,single,integer,—,number,test,cases,line,test,case,string,symbol,w',chef's,photo,line,test,case,single,integer,—,number,chefgram™,filters,lines,single,string,fi,symbol,+,-',string,ith,chefgram™,filter,output,test,case,output,single,line,single,integer,—,answer,chef's,question,modulo,109+7,constraints,≤,≤,|s|,=,≤,≤,10^5,|fi|,=,subtasks,subtask,≤,≤,points,subtask,≤,≤,10^3,points,subtask,≤,≤,10^5,points,sample,input,wwwwwwwwww,+-+-+-+-+-,----------,+---------,wbwbwbwbwb,+-+-+-+-+-,+-+-------,----+-+-+-,bbbbbbbbbb,----------,----------,sample,output,explanation,case,filter,combination,filters,transforming,picture,black,case,chef,apply,filter,invert,whites,apply,filters,order,case,picture,fully,black,identity,filters,chef,apply,empty,subset,filters,filter,filter,author,berezin,tester,6★xcwgf666,editorial,https://discuss.codechef.com/problems/CHEFFILT,tags,frequency,arrays,dp,bitmask,bit,manipulation,observation,data,structures,arrays,advanced,algorithms,advanced,dp,mathematics,algorithms,difficulty,rating,date,added,8-10-2015,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,perl,scala,lua,bash,js,lisp,sbcl,pas,gpc,bf,cloj,caml,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,scm,chicken,pike,scm,qobi,st,nem,submit