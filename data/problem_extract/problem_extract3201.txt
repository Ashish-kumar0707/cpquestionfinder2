read,problems,statements,mandarin,chinese,russian,earth,world,exist,anymore,changed,inevitable,evolution,chef,retains,peoples,dont,play,ordinary,draughts,mankind,enhanced,present,games,held,undirected,graph,board,game,starts,player,chooses,vertex,graph,puts,checker,called,game,checker,players,turns,alternately,single,turn,player,moves,game,checker,current,vertex,neighbour,note,game,players,surrenders,player,moves,considered,winner,game,confusing,strange,imperfect,dont,bother,chef,game,training,training,chef,plays,tired,moves,absolutely,random,choice,initial,position,game,checker,game-graphs,indexed,tiresome,trainer,forces,train,ith,training,session,trainer,numbers,chef,li,ri,ki,chef,carry,simultaneous,games,game-graphs,indexed,li,ri,included,specifically,trainer,order,game-graph,range,li,…,ri,chef,randomly,sets,initial,position,game,checker,steps,choose,random,non-empty,subset,set,allowed,game-graphs,randomly,moves,checker,chosen,game-graphs,training,ends,finite,number,steps,set,current,positions,step,set,initial,positions,note,chef,make,move,training,trainer,training,sessions,chef,ways,play,lead,training,ending,ki,steps,answer,large,print,modulo,input,line,input,single,integer,denoting,number,graphs,description,graphs,line,graph,description,integers,nk,mk,denoting,number,vertices,number,edges,k-th,graph,mk,lines,space,separated,integers,-,1-indexed,indices,vertex,pairs,linked,edge,guaranteed,multiple,edges,edges,incident,vertices,loops,edge,connecting,vertex,graph,descriptions,single,line,integer,denoting,number,training,sessions,lines,space-separated,integers,ith,line,integers,li,ri,ki,describing,ith,training,session,output,query,print,single,integer,-,number,chef,find,modulo,109+7,constraints,subtasks,≤,nk,≤,≤,mk,≤,nk×nk−1/2,≤,≤,2×105,≤,li,≤,ri,≤,≤,ki,≤,subtask,points,li,=,ri,≤,ki,≤,time,limit,seconds,subtask,points,≤,ki,≤,time,limit,seconds,subtask,points,≤,ki,≤,2×103,≤,nk,≤,time,limit,seconds,subtask,points,≤,≤,time,limit,seconds,input,output,input,output,explanation,case,starts,ways,play,length,range,[1,4],similar,number,ways,play,length,equals,4×3,=,number,ways,play,length,equals,10×3,=,case,starts,ways,play,length,=,similar,symmetry,graph,number,ways,equals,3×2+5×2,=,note,undirected,graph,vertex,called,neighbour,vertex,connected,edge,author,5★kaizer,tester,6★laycurse,editorial,https://discuss.codechef.com/problems/CLOWAY,tags,spectral,graph,theory,graph,isomorphism,problem,linear,algebra,fft,advanced,algorithms,advanced,graph,algos,mathematics,algebra,transformations,difficulty,rating,date,added,12-07-2015,time,limit,-,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,perl,scala,lua,bash,js,lisp,sbcl,pas,gpc,bf,cloj,caml,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,scm,chicken,pike,scm,qobi,st,nem,submit