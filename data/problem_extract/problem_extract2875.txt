read,problems,statements,hindi,mandarin,chinese,russian,vietnamese,chef,nn,animals,numbered,nn,cross,river,located,left,bank,chef,animals,located,bank,end,animals,left,unattended,chef,bank,point,time,restrictions,tree,nn,vertices,edge,vertices,uu,vv,denotes,animals,uu,vv,single,boat,chef,animals,cross,river,boat,crossing,river,chef,boat,steer,possibly,animals,animals,boat,left,unattended,capacity,boat,maximum,number,animals,fit,boat,crossing,river,chef,initially,tree,consists,vertex,root,vertices,23…n23…n,added,tree,order,vertex,added,connected,vertices,present,tree,parent,adding,vertex,compute,minimum,required,capacity,boat,chef,animals,move,bank,river,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,single,integer,nn,line,n−1n−1,space-separated,integers,p2p3…pnp2p3…pn,pipi,denotes,parent,vertex,ii,output,print,single,line,n−1n−1,space-separated,integers,ii,1≤i≤n−11≤i≤n−1,ii-th,integers,denote,minimum,capacity,boat,adding,vertex,i+1i+1,constraints,1≤t≤2⋅1051≤t≤2⋅105,2≤n≤1062≤n≤106,1≤pi<i1≤pi<i,valid,ii,sum,nn,test,cases,exceed,subtasks,subtask,#1,points,sum,nn,test,cases,exceed,subtask,#2,points,diameter,tree,subtask,#3,points,sum,nn,test,cases,exceed,2⋅1052⋅105,subtask,#4,points,original,constraints,sample,input,sample,output,explanation,vertex,added,animals,boat,capacity,chef,transport,animals,bank,return,left,bank,transport,animal,bank,vertex,added,animals,animals,left,riverbank,animal,boat,capacity,capacity,strategy,chef,transport,animal,bank,leave,back,left,bank,pick,animal,transport,bank,animal,bank,bring,left,bank,animal,left,bank,bring,bank,finally,pick,animal,left,bank,bring,bank,end,chef,animals,bank,vertex,added,boat,capacity,strategy,transport,animals,bank,return,left,bank,transport,animals,bank,author,7★bciobanu,editorial,https://discuss.codechef.com/problems/RIVER,tags,aug18,bciobanu,bciobanu,hard,likecs,link-cut-tree,matrix-multiplication,tropical-geometry,difficulty,rating,date,added,26-07-2018,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit