read,problem,statements,mandarin,chinese,russian,big,problem,educational,system,chefland,-,impudent,students,cuts,line,cafeteria,chef,assess,problem,understand,queue,works,student,discontent,initially,equal,initially,queue,empty,students,arrive,queue,student,enter,queue,end,\textit{cut,line},stand,front,students,queue,cuts,line,discontent,student,ended,increased,students,enter,queue,order,[]→[1]→[12]→[132]→[1324]→[13524][]→[1]→[12]→[132]→[1324]→[13524],discontent,students,queue,change,[]→[0]→[00]→[001]→[0010]→[00021][]→[0]→[00]→[001]→[0010]→[00021],note,values,discontent,order,students,queue,end,process,order,entering,queue,call,array,discontent,values,order,students,queue,end,process,\textit{the,array,discontent},chef,notices,array,discontent,find,students,cut,line,chef,decides,make,competitive,programming,problem,array,a1a2…ana1a2…an,process,queries,types,find,number,students,cut,line,array,discontent,[alal+1…ar][alal+1…ar],-,subsegment,array,aa,add,number,ww,alal+1…aralal+1…ar,-,subsegment,array,aa,find,number,students,cut,line,initial,aa,array,discontent,input,line,input,integer,nn,3≤n≤5⋅1053≤n≤5⋅105,-,size,array,aa,line,input,nn,integers,a1a2…ana1a2…an,separated,spaces,-,array,aa,line,input,integer,qq,0≤q≤5⋅1050≤q≤5⋅105,-,number,queries,qq,lines,describing,queries,follow,line,starts,integer,tt,-,type,query,t=1t=1,integers,lrlr,follow,1≤l≤r≤n1≤l≤r≤n,query,print,number,students,cut,line,array,discontent,[alal+1…ar][alal+1…ar],t=2t=2,numbers,lrwlrw,follow,1≤l≤r≤n1≤l≤r≤n,|w|<n|w|<n,query,add,ww,numbers,alal+1…aralal+1…ar,guaranteed,time,|ai|≤109|ai|≤109,time,find,number,students,cut,line,array,discontent,consistent,exists,process,results,array,discontent,output,line,output,print,answer,initial,array,aa,print,answers,query,type,order,input,constraints,3≤n≤5⋅1053≤n≤5⋅105,0≤q≤5⋅1050≤q≤5⋅105,0≤ai<n0≤ai<n,0≤|wi|<n0≤|wi|<n,subtasks,points,3≤n≤1053≤n≤105,q=0q=0,points,3≤n≤1053≤n≤105,q≤1000q≤1000,points,3≤n≤1053≤n≤105,q≤105q≤105,points,3≤n≤5⋅1053≤n≤5⋅105,q≤5⋅105q≤5⋅105,sample,input,-1,sample,output,author,5★fairy_winx,editorial,https://discuss.codechef.com/problems/HOTMEALS,tags,lazy,propagation,square,root,decomposition,binary,search,advanced,data,structures,advanced,tree,structures,segment,trees,advanced,algorithms,algorithms,searching,difficulty,rating,date,added,23-02-2021,time,limit,-,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit