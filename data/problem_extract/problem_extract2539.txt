read,problems,statements,mandarin,chinese,russian,vietnamese,chef,loves,single-colored,squares,rectangular,board,size,n×mn×m,consisting,black,cells,white,cells,calculates,cost,board,manner,denote,number,ways,choose,k2k2,white,cells,form,square,edge,length,kk,edges,parallel,borders,board,wkwk,2×32×3,board,consisting,white,cells,black,cells,w1=6w1=6,w2=2w2=2,w3=0w3=0,similarly,denote,number,ways,choose,k2k2,black,cells,forming,square,bkbk,chef,chose,sequences,non-negative,integers,cwcw,cbcb,length,minnmminnm,cost,board,defined,∑i=1minnmcbi⋅bi+cwi⋅wi∑i=1minnmcbi⋅bi+cwi⋅wi,chef,accidentally,spilled,sauce,board,cooking,colors,cells,determined,repaint,cells,black,white,paint,maximum,achievable,cost,resulting,board,note,paint,cells,colors,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,space-separated,integers,nn,mm,nn,lines,follow,ii,1≤i≤n1≤i≤n,ii-th,lines,string,length,mm,describing,ii-th,row,board,—,character,stands,white,cell,stands,black,cell,stands,cell,unknown,color,line,k=minnmk=minnm,space-separated,integers,cw1cw2…cwkcw1cw2…cwk,line,k=minnmk=minnm,space-separated,integers,cb1cb2…cbkcb1cb2…cbk,output,test,case,print,single,line,integer,—,maximum,cost,constraints,1≤t≤51≤t≤5,1≤n⋅m≤5001≤n⋅m≤500,string,characters,0',0≤cwi≤1080≤cwi≤108,valid,ii,0≤cbi≤1080≤cbi≤108,valid,ii,subtasks,subtask,#1,points,1≤n⋅m≤101≤n⋅m≤10,subtask,#2,points,1≤n⋅m≤401≤n⋅m≤40,subtask,#3,points,original,constraints,sample,input,sample,output,explanation,case,replacing,optimal,answer,author,ratingoverflow,tester,6★mgch,tags,hard,june18,likecs,minimum-cut,ratingoverflow,difficulty,rating,date,added,20-05-2018,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit