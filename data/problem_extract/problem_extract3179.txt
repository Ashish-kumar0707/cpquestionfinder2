chef,circular,array,aa,nn,integers,a1a2…ana1a2…an,anan,a1a1,considered,adjacent,subarray,aijaij,defined,array,formed,elements,aa,ithith,index,element,jthjth,index,element,inclusive,formally,aijaij,defined,i≤ji≤j,subarray,aa,index,ii,index,jj,inclusive,i>ji>j,denotes,subarray,aa,index,ii,index,nn,subarray,aa,index,index,jj,function,fbfb,defined,array,bb,number,subarrays,bb,sum,kk,s=∑ni=1∑nj=1faijs=∑i=1n∑j=1nfaij,find,ss,modulo,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,integers,nn,kk,line,nn,space-separated,integers,a1a2…ana1a2…an,output,test,case,print,single,line,integer,―,ss,modulo,constraints,1≤t≤101≤t≤10,1≤n≤2∗1051≤n≤2∗105,|k|≤1015|k|≤1015,|ai|≤109|ai|≤109,valid,ii,sample,input,-1,-1,sample,output,explanation,test,case,array,[1−1][1−1],k=1k=1,fa11=0fa11=0,fa12=2fa12=2,subarrays,[1−1][1−1],[−1][−1],sum,<k<k,fa21=2fa21=2,array,[−11][−11],subarrays,[1−1][1−1],[−1][−1],sum,<k<k,fa22=1fa22=1,sum,answer,author,5★rishup_nitdgp,editorial,https://discuss.codechef.com/problems/RECNDARY,tags,segment,trees,fenwick,trees,prefix,sum,advanced,data,structures,advanced,tree,structures,algorithms,simple,algos,difficulty,rating,date,added,20-03-2020,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit