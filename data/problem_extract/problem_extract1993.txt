read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,chef,string,ss,length,nn,mm,strings,p1p2…pmp1p2…pm,called,patterns,characters,strings,indexed,chef,wondering,find,mm,patterns,string,ss,order,wanted,choose,mm,ranges,denoted,[liri][liri],ii,1≤i≤m1≤i≤m,1≤l1≤r1<l2≤r2<…<lm≤rm≤n1≤l1≤r1<l2≤r2<…<lm≤rm≤n,valid,ii,substring,slisli+1…srislisli+1…sri,equals,pipi,problem,easy,chef,decided,make,harder,permutation,p=p1p2…pmp=p1p2…pm,integers,mm,called,matchable,permutation,chef,reorder,mm,patterns,pp1pp2…ppmpp1pp2…ppm,find,ss,order,chef,find,number,matchable,permutations,input,line,input,space-separated,integers,nn,mm,line,single,string,ss,mm,lines,follow,ii,1≤i≤m1≤i≤m,ii-th,lines,single,string,pipi,output,print,single,line,integer,-,number,matchable,permutations,constraints,1≤n≤1051≤n≤105,1≤m≤141≤m≤14,1≤|pi|≤1051≤|pi|≤105,valid,ii,sp1p2…pmsp1p2…pm,lowercase,english,letters,subtasks,subtask,#1,points,1≤m≤31≤m≤3,subtask,#2,points,1≤n≤10001≤n≤1000,subtask,#3,points,original,constraints,input,abbabacbac,ab,ac,output,explanation,3=63=6,permutations,matchable,permutations,correspond,permutations,patterns,ab,ac,ab,ac,ab,ac,found,ss,order,input,aaa,aa,aa,output,explanation,match,patterns,ranges,intersect,input,aaaa,aa,aa,output,explanation,matchable,permutations,author,6★triplem5ds,editorial,https://discuss.codechef.com/problems/MATPER,tags,dp,bitmask,kmp,algorithm,bitmasking,meet,middle,prefix,sum,advanced,algorithms,advanced,dp,string,matching,mathematics,bit,manipulation,algorithms,simple,algos,difficulty,rating,date,added,26-02-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit