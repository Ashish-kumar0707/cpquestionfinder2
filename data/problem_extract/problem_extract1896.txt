read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,nikitas,study,exams,decided,disruptor,part-time,job,tax,collector,airland,airland,consists,nn,houses,numbered,one-way,supply,pathways,connect,house,budget,denote,budget,house,bi,coins,neighbourhood,house,set,houses,supply,house,supplied,house,directly,indirectly,including,nikitas,choose,start,tax-collecting,journey,house,move,supply,pathways,visit,houses,collect,taxes,valid,nikitas,visits,house,time,including,house,starts,journey,visited,house,neighbourhood,house,choose,positive,integer,announce,house,neighbourhood,pay,coins,taxes,house,budget,asked,pay,coins,things,happen,c≤b,house,pays,tax,c>b,house,afford,pay,tax,pay,note,house,asked,pay,taxes,houses,afford,pay,announced,tax,pay,nikitas,continue,journey,collect,money,careful,―,end,houses,asked,pay,tax,pay,afford,captain,airland,katana,capture,nikitas,end,tax-collecting,journey,earning,money,nikitas,earns,money,collected,nikitas,maximise,amount,money,make,luckily,information,supply,pathways,airland,offer,nikitas,calculate,maximum,amount,money,make,captured,number,large,compute,modulo,109+21,input,line,input,single,integer,denoting,number,test,cases,description,test,cases,line,test,case,space-separated,integers,line,space-separated,integers,b1b2…bn,lines,follow,lines,space-separated,integers,denoting,starting,ending,house,supply,pathway,output,test,case,print,single,line,integer,―,maximum,amount,money,nikitas,make,captured,modulo,109+21,constraints,1≤t≤5,3≤n≤105,1≤m≤2⋅105,1≤bi≤109,valid,0≤k≤200,sum,test,cases,exceed,sum,test,cases,exceed,2⋅105,subtasks,subtask,#1,points,k=0,3≤n≤1000,1≤m≤5⋅104,sum,test,cases,exceed,5⋅104,subtask,#2,points,k=1,3≤n≤1000,1≤m≤5⋅104,sum,test,cases,exceed,5⋅104,subtask,#3,points,3≤n≤1000,1≤m≤5⋅104,0≤k≤100,sum,test,cases,exceed,5⋅104,subtask,#4,points,original,constraints,sample,input,sample,output,explanation,case,nikitas,start,house,supplied,house,coins,move,house,house,neighbourhood,house,houses,house,supplies,house,directly,house,indirectly,house,house,supplies,house,directly,pay,k=1,nikitas,house,pay,coins,house,8⋅2=16,coins,total,houses,end,nikitas,earns,9+16=25,coins,author,4★stelkasouridis,editorial,https://discuss.codechef.com/problems/MAXTAX,tags,dp,approach,strongly,connected,components,topological,sorting,algorithms,dynamic,programming,graph,algos,dag,algos,difficulty,rating,date,added,29-01-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit