read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,chef,experimenting,kitchen,nn,spices,numbered,n−1n−1,types,s0s1…sn−1,answer,queries,query,integers,query,chef,spices,slsl+1…sr,order,make,dish,clue,order,make,perfect,dish,orders,sequences,created,permuting,r−l+1,spices,find,chef,number,distinct,orders,sequences,spices,number,large,compute,modulo,109+7,sequences,spices,considered,valid,index,type,i-th,spice,sequence,type,i-th,spice,sequence,note,input,encoded,answer,queries,online,input,line,input,space-separated,integers,line,space-separated,integers,s0s1s2…sn−1,lines,space-separated,integers,l1,l2,r1,r2,describing,query,parameters,calculated,denote,answer,previous,query,query,a=0,calculate,l=l1⋅a+l2%n,r=r1⋅a+r2%n,l>r,swap,output,query,print,single,line,integer,—,number,distinct,orders,spices,modulo,109+7,constraints,1≤nq≤3⋅105,1≤si≤109,valid,0≤l1l2r1r2≤n−1,subtasks,subtask,#1,points,1≤nq≤103,subtask,#2,points,1≤nq≤105,l1=r1=0,subtask,#3,points,1≤nq≤105,subtask,#4,points,original,constraints,sample,input,sample,output,author,5★coolreshab,editorial,https://discuss.codechef.com/problems/COOLCHEF,tags,square,root,decomposition,coordinate,compression,permutations,combinations,online,queries,advanced,algorithms,pre,processing,mathematics,combinatorics,algorithms,queries,difficulty,rating,date,added,29-04-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit