define,fxfx,largest,divisor,xx,equal,xx,case,x=1x=1,define,f1=1f1=1,exception,tree,nn,nodes,numbered,nn,node,ii,vivi,assigned,define,gxrgxr,1≤xr≤n1≤xr≤n,number,arrays,nodes,aa,satisfy,conditions,1≤ai≤n1≤ai≤n,aiai,represents,node,tree,a1=xa1=x,ai≠ajai≠aj,1≤i<j≤|a|1≤i<j≤|a|,distance,node,aiai,a1a1,rr,1<i≤|a|1<i≤|a|,distance,nodes,aiai,a1a1,tree,defined,number,edges,simple,path,aiai,a1a1,vai=fvai−1vai=fvai−1,vai=vai−1vai=vai−1,1<i≤|a|1<i≤|a|,arrays,considered,length,element,position,qq,queries,integers,xx,rr,find,gxrgxr,number,large,output,modulo,109+7109+7,input,format,line,input,integer,nn,-,number,nodes,tree,line,nn,space-separated,integers,v1v2…vnv1v2…vn,-,values,nodes,n−1n−1,lines,space-separated,integers,uu,vv,denoting,edge,node,uu,vv,tree,line,integer,qq,-,number,queries,qq,lines,space-separated,integer,xx,rr,-,initial,node,distance,query,output,format,query,output,single,line,gxrmod109+7gxrmod109+7,constraints,1≤n≤1051≤n≤105,1≤vi≤1051≤vi≤105,1≤uv≤n1≤uv≤n,u≠vu≠v,1≤q≤1041≤q≤104,1≤xr≤n1≤xr≤n,sample,input,sample,output,explanation,query,array,[3][3],query,arrays,[3][3],[31][31],[314][314],[317][317],[3147][3147],[3174][3174],author,6★gupta_nitin,editorial,https://discuss.codechef.com/problems/CNTSEQ,tags,centroid,decomposition,sieve,eratosthenes,combinatorics,advanced,algorithms,advanced,graph,algos,mathematics,number,theory,difficulty,rating,date,added,17-11-2021,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit