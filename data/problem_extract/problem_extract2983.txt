read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,chef,recently,accepted,teaching,fellowship,prestigious,culinary,institution,fellowship,begin,chef,remaining,free,time,nice,vacation,nn,cities,numbered,nn,connected,mm,roads,valid,ii,lili,tourist,attractions,city,ii,chef,initially,city,teach,city,nn,day,vacation,chef,perform,actions,travel,city,higher,number,current,city,directly,connected,current,city,road,end,vacation,chef,city,nn,visit,tourist,attraction,current,city,chef,visit,tourist,attraction,repeatedly,days,chef,decided,days,vacation,qq,queries,sequence,d1d2…dqd1d2…dq,query,ii,1≤i≤q1≤i≤q,number,vacation,plans,vacation,didi,days,numbers,large,compute,modulo,vacation,plans,fixed,duration,vacation,considered,day,chef,performs,actions,plans,day,visiting,tourist,attractions,counts,actions,input,line,input,space-separated,integers,nn,mm,qq,line,nn,space-separated,integers,l1l2…lnl1l2…ln,mm,lines,space-separated,integers,uu,vv,denoting,cities,uu,vv,connected,road,line,qq,space-separated,integers,d1d2…dqd1d2…dq,output,query,print,single,line,integer,―,number,vacations,modulo,constraints,1≤n≤40001≤n≤4000,1≤m≤1051≤m≤105,1≤q≤5001≤q≤500,1≤li≤1051≤li≤105,valid,ii,1≤u<v≤n1≤u<v≤n,1≤di≤10181≤di≤1018,valid,ii,subtasks,subtask,#1,points,di≤2000di≤2000,valid,ii,subtask,#2,points,n≤10n≤10,subtask,#3,points,n≤1500n≤1500,di≤50000di≤50000,valid,ii,subtask,#4,points,n≤100n≤100,subtask,#5,points,original,constraints,sample,input,sample,output,explanation,road,directly,connecting,city,city,valid,vacations,day,answer,query,ways,city,days,travel,city,city,day,city,city,day,travel,city,city,day,city,city,day,option,chef,time,sightseeing,days,chef,spend,day,tourist,attraction,days,travelling,trips,total,author,david_adm,editorial,https://discuss.codechef.com/problems/TRIPWAYS,tags,graphs,generating,functions,matrix,exponentiation,berlekamp,massey,algorithm,data,structures,mathematics,sequences,progression,matrices,error,detection,matrix,multiplication,difficulty,rating,date,added,17-02-2020,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit