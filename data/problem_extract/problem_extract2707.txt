read,problems,statements,hindi,mandarin,chinese,russian,vietnamese,bengali,nn,chefs,numbered,nn,mm,dishes,numbered,mm,valid,ii,ii-th,chef,cook,dishes,type,fifi,chef,friend,kk,chefs,chef,cooks,dish,asks,chefs,friends,cook,dish,evaluate,dish,chef,evaluate,dish,chefs,arranged,row,chef,chef,nn,chefina,choose,valid,integers,ll,rr,chefs,ll+1…rll+1…r,cook,dishes,evaluated,choose,ll,rr,nn,chefs,evaluates,dish,find,number,pairs,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,space-separated,integers,nn,mm,kk,line,nn,space-separated,integers,f1f2…fnf1f2…fn,nn,lines,follow,ii,1≤i≤n1≤i≤n,ii-th,lines,kk,space-separated,integers,d1d2…dkd1d2…dk,denoting,friends,ii-th,chef,output,test,case,print,single,line,integer,―,number,pairs,chef,evaluates,dish,constraints,1≤t≤10001≤t≤1000,1≤m≤n≤3⋅1051≤m≤n≤3⋅105,1≤k≤31≤k≤3,1≤fi≤m1≤fi≤m,valid,ii,1≤di≤n1≤di≤n,valid,ii,=dii,=di,valid,ii,d1d2…dkd1d2…dk,pairwise,disticnt,sum,n⋅k+1n⋅k+1,test,cases,exceed,2⋅1062⋅106,sample,input,sample,output,author,5★rishup_nitdgp,editorial,https://discuss.codechef.com/problems/CHEFPRTY,tags,lazy,propagation,pointers,advanced,data,structures,advanced,tree,structures,segment,trees,algorithms,simple,algos,difficulty,rating,date,added,15-08-2020,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit