read,problems,statements,mandarin,chinese,russian,vietnamese,chefland,cities,one-way,roads,cities,chef,travel,cities,roads,unusual,bike,circumference,front,wheel,number,cities,circumference,rear,wheel,-,circumference,wheel,broken,equal-spaced,positions,front,wheel,positions,n-1,rear,wheel,positions,n-2,unit,distance,travelled,advance,wheel,position,chef,travels,distance,wheels,start,position,position,front,wheel,left,mod,position,rear,wheel,left,mod,-,chef,bikes,fast,roads,bumpy,frequently,wheel,touching,ground,wheel,turn,bike,lubrication,front,rear,wheel,rotate,total,number,positions,travelling,road,road,start,city,s[i],end,city,e[i],distance,front,wheel,travels,f[i],distance,rear,wheel,r[i],wheels,start,position,beginning,chef's,trip,traveling,sequence,roads,i1i2,ik,front,wheel,position,=,f[i1],+,f[i2],+,+,f[ik],mod,similarly,rear,wheel,position,=,r[i1],+,r[i2],+,+,r[ik],mod,n-1,chef,start,end,city,starting,city,chef,visiting,city,journey,counts,destinations,chef,interested,calculating,number,paths,final,positions,equal,values,number,roads,traversed,equals,road,counts,answer,large,output,answer,mod,input,line,integers,indicating,number,cities,circumference,front,wheel,circumference,rear,wheel,number,roads,number,roads,chef,travel,remember,chef,travels,road,counts,lines,describe,road,i'th,line,integers,s[i],e[i],f[i],r[i],describe,road,output,output,arranged,blocks,k'th,block,≤,≤,lines,consisting,n-1,integers,j'th,number,i'th,line,k'th,block,describe,number,ways,chef,start,end,bike,tour,city,crosses,precisely,roadss,leaves,front,wheel,position,=,rear,wheel,position,=,number,output,reduced,modulo,constraints,≤,≤,≤,≤,≤,≤,≤,s[i],≤,≤,t[i],≤,≤,f[i],≤,r[i],≤,f[i],≤,roads,cities,roads,city,subtask,#1,[10,points],≤,≤,subtask,#2,[20,points],≤,sample,input,sample,output,explanation,discovered,marvellous,enumeration,margin,narrow,author,6★wwwwodddd,tester,6★xcwgf666,editorial,https://discuss.codechef.com/problems/BIKE,tags,directed,graphs,mathematics,matrix,exponentiation,data,structures,graphs,matrices,matrix,multiplication,difficulty,rating,date,added,15-09-2016,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,perl,scala,lua,bash,js,lisp,sbcl,pas,gpc,bf,cloj,caml,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,scm,chicken,pike,scm,qobi,st,nem,submit