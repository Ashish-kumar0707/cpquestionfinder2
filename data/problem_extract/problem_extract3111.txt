read,problems,statements,mandarin,chinese,russian,vietnamese,hussain,met,friend,alex,finally,time,alex,travelled,usa,hussain,decided,treat,problem,hussain,challenged,alex,solve,task,hussain,binary,tree,initially,consisting,node,called,root,label,binary,tree,tree,number,children,node,tree,nice,property,end,leaf,node,children,labelled,produce,children,left,child,labelled,2*x,child,labelled,2*x+1,node,child,reproduces,existing,child,affected,hussain,perform,operations,tree,make,tree,travel,future,seconds,seconds,pass,put,robot,root,tree,instruct,robot,walk,tree,string,commands,command,makes,robot,left,child,command,makes,child,guaranteed,commands,valid,robot,finishes,executing,string,commands,explodes,node,present,entire,subtree,beneath,deleted,assume,entire,operation,instantaneous,time,hussain,perform,operations,tree,operation,alex,number,nodes,left,tree,modulo,109+7,input,line,single,integer,number,testcases,testcase,line,testcase,single,integer,denoting,number,operations,lines,testcase,integer,cmd,beginning,cmd,equals,cmd,=,hussain,make,tree,travel,future,line,integer,denoting,number,seconds,pass,hussain,runs,time,machine,cmd,=,hussain,send,robot,non-empty,string,describing,sequence,commands,robot,follow,reach,existing,node,destroys,subtree,note,case,string,nonempty,root,deleted,output,testcase,output,lines,i-th,number,nodes,tree,performing,i-th,query,modulo,109+7,constraints,≤,≤,≤,≤,*,query,cmd,=,≤,≤,query,cmd,=,string,commands,consist,characters,r',guaranteed,commands,valid,robot,land,existing,node,command,asks,robot,left,child,left,child,sum,lengths,strings,type,command,testfile,exceed,sum,time,shift,testfile,exceed,sum,commands,testfile,exceed,sample,input,lr,rrr,sample,output,explanation,explain,testcase,beginning,root,tree,hussain,time,travels,forward,operation,tree,operation,deletes,node,tree,hussain,time,travels,tree,operation,node,exploded,children,tree,time,travelled,tree,time,travelled,tree,count,number,nodes,left,tree,operation,form,output,author,3★deadwing97,tester,6★kingofnumbers,tags,dp,trees,dfs,advanced,algorithms,advanced,dp,algorithms,graph,algos,traversals,difficulty,rating,date,added,21-05-2017,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,perl,scala,lua,bash,js,lisp,sbcl,pas,gpc,bf,cloj,caml,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,scm,chicken,pike,scm,qobi,st,nem,submit