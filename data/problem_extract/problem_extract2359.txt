read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,original,chef,gordon,ramsay,problem,chef,wanted,close,restaurants,arch-rival,gordon's,secret,restaurant,placement,formula,decide,leave,open,ensure,success,chef,seeking,expand,chain,restaurants,town,dastardly,gordon,set,chain,restaurants,chef,conducts,industrial,espionage,market,research,discovers,gordon's,secret,restaurant,placement,formula,town,optimal,arrange,restaurants,triples,time,restaurants,optimal,triple,equidistant,chef,wondering,number,ways,build,optimally,successful,triple,restaurants,town,formally,town,nn,sites,numbered,nn,connected,n−1n−1,bidirectional,roads,length,road,mile,site,vv,reached,site,uu,roads,pair,sites,uu,vv,distuvdistuv,length,miles,shortest,sequence,roads,connects,uu,vv,sites,deemed,suitable,building,restaurant,sites,unsuitable,chef,find,number,ways,choose,ordered,triple,sites,pqrpqr,build,restaurants,arrangement,restaurants,optimally,successful,pp,qq,rr,pairwise,distinct,pp,qq,rr,suitable,sites,pp,qq,rr,equidistant,distpq=distqr=distrpdistpq=distqr=distrp,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,single,integer,nn,n−1n−1,lines,space-separated,integers,uu,vv,denoting,sites,uu,vv,connected,road,line,nn,space-separated,integers,s1s2…sns1s2…sn,si=1si=1,denotes,site,ii,suitable,si=0si=0,denotes,suitable,output,test,case,print,single,line,integer,―,number,triples,sites,result,optimally,successful,arrangements,restaurants,constraints,1≤t≤10001≤t≤1000,1≤n≤2000001≤n≤200000,1≤uv≤n1≤uv≤n,si∈{01}si∈{01},valid,ii,sum,nn,test,cases,exceed,subtasks,subtask,#1,points,t≤100t≤100,n≤100n≤100,subtask,#2,points,t≤100t≤100,n≤1000n≤1000,subtask,#3,points,original,constraints,sample,input,sample,output,explanation,care,suitable,sites,site,part,optimally,successful,triple,case,suitable,sites,sites,form,triple,distinct,suitable,sites,case,suitable,sites,distance,miles,triple,consisting,sites,drawn,suitable,sites,results,optimally,successful,arrangement,case,suitable,sites,labelled,dist24=dist45=3dist24=dist45=3,miles,dist52=2dist52=2,miles,suitable,sites,equidistant,case,suitable,sites,dist15=dist57=dist71=2dist15=dist57=dist71=2,miles,triple,results,optimally,successful,arrangement,dist13=dist34=dist41=4dist13=dist34=dist41=4,miles,triple,results,optimally,successful,arrangement,finally,dist34=dist47=dist73=4dist34=dist47=dist73=4,miles,triple,results,optimally,successful,arrangement,triples,total,author,6★ssjgz,editorial,https://discuss.codechef.com/problems/CHGORAM2,tags,trees,dp,trees,dsu,trees,observation,data,structures,graphs,advanced,algorithms,advanced,dp,advanced,graph,algos,algorithms,difficulty,rating,date,added,19-01-2020,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit