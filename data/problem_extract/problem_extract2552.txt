read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,chef,relaxing,outdoors,poor,performance,university,varsity's,yearly,week-long,training,retreat,mountains,sign,continue,competitive,programming,times,feel,insurmountably,difficult,looked,dazzling,rainbow,sky,moved,beauty,nature,decided,continue,programming,created,problem,mathematical,rainbow,road,rainbow,road,grid,mm,rows,numbered,mm,top,bottom,nn,columns,numbered,nn,left,denote,cell,row,ii,column,jj,ijij,cell,top,left,corner,mnmn,cell,bottom,corner,chef,selected,nn,distinct,positive,integers,a1a2…ana1a2…an,colours,painted,stripes,road,numbers,valid,jj,cell,column,jj,ajaj,answer,qq,queries,query,integer,kk,chef,travel,cell,cell,knkn,travel,cell,cell,directly,cell,directly,exist,formally,chef,cell,ijij,travel,i+1ji+1j,ij+1ij+1,define,path,sequence,cells,c1c2…csc1c2…cs,ii,1≤i<s1≤i<s,chef,travel,cell,cici,cell,ci+1ci+1,weight,path,product,values,cells,path,chef,find,sum,weights,paths,start,cell,end,cell,knkn,number,large,compute,modulo,998244353=7⋅17⋅223+1998244353=7⋅17⋅223+1,prime,number,input,line,input,space-separated,integers,mm,nn,qq,line,nn,space-separated,integers,a1a2…ana1a2…an,qq,lines,follow,lines,single,integer,kk,describing,query,output,query,print,single,line,integer,―,sum,weights,paths,modulo,constraints,1≤m≤10181≤m≤1018,1≤n≤1051≤n≤105,1≤q≤1051≤q≤105,1≤ai<9982443531≤ai<998244353,valid,ii,a1a2…ana1a2…an,pairwise,distinct,1≤k≤m1≤k≤m,subtasks,subtask,points,mn≤2000mn≤2000,subtask,points,m≤105m≤105,subtask,points,q≤10q≤10,n≤2000n≤2000,subtask,points,q≤10q≤10,input,output,explanation,query,path,11→12→1311→12→13,path,weight,1⋅3⋅5=151⋅3⋅5=15,query,paths,11→12→13→2311→12→13→23,weight,1⋅3⋅5⋅5=751⋅3⋅5⋅5=75,11→12→22→2311→12→22→23,weight,1⋅3⋅3⋅5=451⋅3⋅3⋅5=45,11→21→22→2311→21→22→23,weight,1⋅1⋅3⋅5=151⋅1⋅3⋅5=15,input,output,explanation,query,paths,weights,sum,input,output,author,3★shisuko,editorial,https://discuss.codechef.com/problems/RNBWROAD,tags,number,theory,generating,functions,fft,mathematics,sequences,progression,transformations,difficulty,rating,date,added,29-03-2020,time,limit,secs,source,limit,bytes,languages,cpp17,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,sql,scm,guile,perl6,erl,clps,prlg,sqlq,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit