read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,sonya,lives,magical,land,consists,nn,cities,numbered,nn,n−1n−1,roads,connecting,words,country,sonya,lives,tree,country,magical,toys,infinite,number,types,made,types,toys,labeled,integers,city,toy,store,sells,infinite,number,toys,type,stores,make,toys,types,stores,valid,ii,integer,jj,quality,toy,type,jj,store,city,ii,ki⋅j+biki⋅j+bi,kiki,bibi,parameters,store,sonya,loves,buy,toys,magical,land,gifts,friends,types,toys,friends,decides,buy,toy,type,zz,travels,shortest,path,cities,uu,vv,buys,toy,chosen,type,zz,toy,maximum,quality,toys,type,found,stores,path,including,stores,cities,uu,vv,maximum,quality,reforms,magical,land,change,parameters,stores,reform,shortest,path,cities,uu,vv,chosen,parameters,xx,yy,city,cc,path,including,uu,vv,kckc,increased,xx,bcbc,increased,yy,task,process,qq,queries,types,uu,vv,xx,yy,reform,uu,vv,zz,sonya,maximum,qualities,toys,type,zz,sold,simple,path,cities,uu,vv,input,line,input,space-separated,integers,nn,qq,line,nn,space-separated,integers,—,initial,values,k1k2…knk1k2…kn,line,nn,space-separated,integers,—,initial,values,b1b2…bnb1b2…bn,n−1n−1,lines,space-separated,integers,uu,vv,denoting,cities,uu,vv,connected,road,qq,lines,describe,queries,lines,starts,space-separated,integers,tt,uu,vv,tt,denotes,type,current,query,t=1t=1,space,space-separated,integers,xx,yy,t=2t=2,space,integer,zz,output,query,type,print,single,line,integer,—,maximum,quality,toy,sonya,buy,constraints,1≤nq≤1051≤nq≤105,1≤uv≤n1≤uv≤n,|ki|≤108|ki|≤108,valid,ii,|bi|≤1016|bi|≤1016,valid,ii,|x|≤104|x|≤104,|y||z|≤109|y||z|≤109,1≤t≤21≤t≤2,graph,input,tree,subtasks,subtask,#1,points,1≤nq≤50001≤nq≤5000,subtask,#2,points,city,directly,connected,cities,subtask,#3,points,original,constraints,sample,input,-1,-1,-5,-4,-14,-20,-7,-5,-1,sample,output,-21,author,7★smelskiy,tags,hld,dfs,advanced,algorithms,advanced,graph,algos,algorithms,graph,algos,traversals,difficulty,rating,date,added,27-04-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit