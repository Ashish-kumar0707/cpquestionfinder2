read,problem,statements,hindi,bengali,mandarin,chinese,russian,vietnamese,perfect,tree,rooted,tree,leaves,distance,root,perfect,tree,nn,vertices,time,xx,wx=maxp∑i=1ndistpi⋅xi−1wx=maxp∑i=1ndistpi⋅xi−1,vertices,tree,arbitrarily,numbered,nn,maximum,permutations,pp,integers,nn,distudistu,denotes,distance,vertex,uu,root,chef,perfect,tree,nn,vertices,numbered,nn,rooted,vertex,vertex,vv,tree,subtree,rooted,vv,note,perfect,tree,defined,sum,permutations,vertices,subtree,distdist,denotes,distance,vertex,vv,answer,qq,queries,query,chef,parametres,vv,yy,subtree,rooted,vertex,vv,time,yy,queries,encoded,answered,online,values,large,compute,modulo,109+7109+7,input,line,input,single,integer,tt,denoting,number,test,cases,description,tt,test,cases,line,test,case,space-separated,integers,nn,qq,n−1n−1,lines,space-separated,integers,uu,vv,denoting,edge,vertices,uu,vv,qq,lines,describe,queries,lines,space-separated,integers,aa,bb,parametres,vv,yy,computed,denote,answer,previous,query,ansans,ans=0ans=0,query,v=a⊕ansv=a⊕ans,y=b⊕ansy=b⊕ans,output,query,print,single,line,integer,-,subtree,modulo,109+7109+7,constraints,1≤t≤51≤t≤5,1≤n≤2000001≤n≤200000,1≤q≤1000001≤q≤100000,1≤uv≤n1≤uv≤n,1≤y<109+71≤y<109+7,graph,input,perfect,tree,sum,nn,test,cases,exceed,sum,qq,test,cases,exceed,subtasks,subtask,points,1≤1≤,sum,nn,test,cases,≤10000≤10000,1≤1≤,sum,qq,test,cases,≤8000≤8000,subtask,points,original,constraints,sample,input,sample,output,explanation,case,query,choice,permutation,pp,irrelevant,sum,tree,sum,distances,vertices,vertex,answer,0+1+1+2+2+2=80+1+1+2+2+2=8,query,v=2v=2,y=2y=2,query,v=3v=3,y=3y=3,author,7★yash_chandnani,editorial,https://discuss.codechef.com/problems/PTREE,tags,trees,modulo,multiplicative,inverse,gp,dfs,observation,data,structures,graphs,mathematics,modular,arithmetic,sequences,progression,algorithms,graph,algos,traversals,difficulty,rating,date,added,14-02-2019,time,limit,secs,source,limit,bytes,languages,pyth,java,cpp14,pyth,pyp3,cs2,ada,pypy,text,pas,fpc,nodejs,ruby,php,hask,tcl,kotlin,perl,scala,lua,bash,js,rust,lisp,sbcl,pas,gpc,bf,cloj,caml,swift,fort,asm,fs,wspc,lisp,clisp,scm,guile,perl6,erl,clps,prlg,ick,nice,icon,cob,scm,chicken,pike,scm,qobi,st,nem,submit